[[refarch_details]]

===  Virtual Private Cloud

An AWS VPC provides the ability to set up custom virtual networking which includes subnets,
IP address ranges, route tables and gateways. In this reference implementation
guide, a dedicated VPC is created with all its accompanying services to provide a
stable network for our OpenShift v3 deployment.

A VPC is created as a logical representation of a networking environment in the Amazon Web Services cloud. The following subnets and CIDR listed below are used. Make sure to substitute values that do not conflict with an existing CIDR or subnet in the environment.


.VPC Networking
|====
^|CIDR / Subnet ^| Values
| CIDR | 10.30.0.0/16
| Private Subnet 1 | 10.30.1.0/24
| Private Subnet 2 | 10.30.2.0/24
| Private Subnet 3 | 10.30.3.0/24
| Public Subnet 1 | 10.30.4.0/24
| Public Subnet 2 | 10.30.5.0/24
| Public Subnet 3 | 10.30.6.0/24
|====

The VPC is created and then a human readable tag is assigned. Six subnets are created and tagged in the VPC. Three subnets are considered public and three subnets are private. The design of one public and one private subnet per Availability Zone allows for high availibility.  The public subnets are used for the bastion instance and the two external Elastic Load Balancers.  The Bastion Instance is part of the public subnet due to its role as the SSH jumpbox. The two external ELBs allow access to the OpenShift master and the routing of application traffic. In the public route table, an internet gateway and routes are defined and attached to the VPC. The route table has a destination internet gateway associated so that traffic can exit the VPC. The private subnets use the NAT Gateway to communicate to the internet for packages, container images, and Github repositories. The private subnets are assigned their own route table with the NAT Gateway defined. The master, infrastructure, and application nodes are in the private network, as well as, the internal-openshift-master which ensures the nodes cannot be accessed externally. Finally DNS hostnames are enables so that anything that gets added to that VPC gets a DNS hostname.

For more information see https://aws.amazon.com/vpc/
// vim: set syntax=asciidoc:
