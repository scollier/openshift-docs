<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>OpenShift Origin Branch Build | Using Images | Database Images | MySQL</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css">
  <link href="../../../scollier-test/_stylesheets/docs.css" rel="stylesheet" />
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png">
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://assets.openshift.net/content/html5shiv.js" type="text/javascript"></script>
    <script src="https://assets.openshift.net/content/respond.js" type="text/javascript"></script>
    <link href="https://assets.openshift.net/content/vendor/respond-js/respond-proxy.html" id="respond-proxy" rel="respond-proxy">
    <link href="../../../scollier-test/_images/respond.proxy.gif" id="respond-redirect" rel="respond-redirect">
    <script src="../../../scollier-test/_javascripts/respond.proxy.js" type="text/javascript"></script>
  <![endif]-->
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="../../../scollier-test/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script async src="//www.google-analytics.com/analytics.js" type="text/javascript"></script>
<script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-40375612-1', 'openshift.org');
  ga('set', 'forceSSL', true);
  ga('send', 'pageview');
</script>
</head>
<body>
  <div class="navbar navbar-default navbar-openshift navbar-origin" role="navigation">
  <div class="navbar-header">
    <a class="navbar-brand origin" href="/"></a>
  </div>
</div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../../index.html">Documentation</a>
      </li>
      <li class="hidden-xs active">
        <a href="../../welcome/index.html">OpenShift Origin Branch Build</a>
      </li>
      <li class="hidden-xs active">
        Using Images
      </li>
      <li class="hidden-xs active"><a href="../../using_images/db_images/index.html">Database Images</a></li>
      <li class="hidden-xs active">
        MySQL
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <div class="row-fluid">
          <script>
  (function() {
    var cx = '013769182564158614814:vdyz7waqya4';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>About
      </a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../../welcome/index.html">Welcome</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>What's New?
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../../whats_new/index.html">Overview</a></li>
            <li><a class="" href="../../whats_new/applications.html">Applications</a></li>
            <li><a class="" href="../../whats_new/carts_vs_images.html">Cartridges vs Images</a></li>
            <li><a class="" href="../../whats_new/terminology.html">Terminology</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>Getting Started
      </a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../../getting_started/index.html">Overview</a></li>
            <li><a class="" href="../../getting_started/developers_console.html">Web Console Walkthrough</a></li>
            <li><a class="" href="../../getting_started/administrators.html">Setting Up a Cluster</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>Architecture
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../../architecture/index.html">Overview</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-1">
                <span id="sgSpan-3-1" class="fa fa-caret-right"></span>&nbsp;Infrastructure Components
              </a>
              <ul id="topicSubGroup-3-1" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../architecture/infrastructure_components/kubernetes_infrastructure.html">Kubernetes Infrastructure</a></li>
                  <li><a class="" href="../../architecture/infrastructure_components/image_registry.html">Image Registry</a></li>
                  <li><a class="" href="../../architecture/infrastructure_components/web_console.html">Web Console</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-2">
                <span id="sgSpan-3-2" class="fa fa-caret-right"></span>&nbsp;Core Concepts
              </a>
              <ul id="topicSubGroup-3-2" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../architecture/core_concepts/index.html">Overview</a></li>
                  <li><a class="" href="../../architecture/core_concepts/containers_and_images.html">Containers and Images</a></li>
                  <li><a class="" href="../../architecture/core_concepts/pods_and_services.html">Pods and Services</a></li>
                  <li><a class="" href="../../architecture/core_concepts/projects_and_users.html">Projects and Users</a></li>
                  <li><a class="" href="../../architecture/core_concepts/builds_and_image_streams.html">Builds and Image Streams</a></li>
                  <li><a class="" href="../../architecture/core_concepts/deployments.html">Deployments</a></li>
                  <li><a class="" href="../../architecture/core_concepts/routes.html">Routes</a></li>
                  <li><a class="" href="../../architecture/core_concepts/templates.html">Templates</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-3">
                <span id="sgSpan-3-3" class="fa fa-caret-right"></span>&nbsp;Additional Concepts
              </a>
              <ul id="topicSubGroup-3-3" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../architecture/additional_concepts/networking.html">Networking</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/sdn.html">OpenShift SDN</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/authentication.html">Authentication</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/authorization.html">Authorization</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/storage.html">Persistent Storage</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/remote_commands.html">Remote Commands</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/port_forwarding.html">Port Forwarding</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/throttling.html">Throttling</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/scm.html">Source Control Management</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/admission_controllers.html">Admission Controllers</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/other_api_objects.html">Other API Objects</a></li>
              </ul>
            </li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-right"></span>Installation and Configuration
      </a>
      <ul id="topicGroup4" class="collapse  list-unstyled">
            <li><a class="" href="../../install_config/index.html">Overview</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-1">
                <span id="sgSpan-4-1" class="fa fa-caret-right"></span>&nbsp;Installing
              </a>
              <ul id="topicSubGroup-4-1" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/install/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/install/prerequisites.html">Prerequisites</a></li>
                  <li><a class="" href="../../install_config/install/rpm_vs_containerized.html">RPM vs Containerized</a></li>
                  <li><a class="" href="../../install_config/install/quick_install.html">Quick Installation</a></li>
                  <li><a class="" href="../../install_config/install/advanced_install.html">Advanced Installation</a></li>
                  <li><a class="" href="../../install_config/install/docker_registry.html">Deploying a Docker Registry</a></li>
                  <li><a class="" href="../../install_config/install/deploy_router.html">Deploying a Router</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-2">
                <span id="sgSpan-4-2" class="fa fa-caret-right"></span>&nbsp;Upgrading
              </a>
              <ul id="topicSubGroup-4-2" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/upgrading/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/upgrading/automated_upgrades.html">Automated Upgrades</a></li>
                  <li><a class="" href="../../install_config/upgrading/manual_upgrades.html">Manual Upgrades</a></li>
              </ul>
            </li>
            <li><a class="" href="../../install_config/master_node_configuration.html">Master and Node Configuration</a></li>
            <li><a class="" href="../../install_config/imagestreams_templates.html">Loading the Default Image Streams and Templates</a></li>
            <li><a class="" href="../../install_config/certificate_customization.html">Configuring Custom Certificates</a></li>
            <li><a class="" href="../../install_config/configuring_authentication.html">Configuring Authentication and User Agent</a></li>
            <li><a class="" href="../../install_config/syncing_groups_with_ldap.html">Syncing Groups With LDAP</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-8">
                <span id="sgSpan-4-8" class="fa fa-caret-right"></span>&nbsp;Advanced LDAP Configuration
              </a>
              <ul id="topicSubGroup-4-8" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/sssd_for_ldap_failover.html">Setting up SSSD for LDAP Failover</a></li>
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/configuring_form_based_authentication.html">Configuring Form-Based Authentication</a></li>
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/configuring_extended_ldap_attributes.html">Configuring Extended LDAP Attributes</a></li>
              </ul>
            </li>
            <li><a class="" href="../../install_config/configuring_sdn.html">Configuring the SDN</a></li>
            <li><a class="" href="../../install_config/configuring_aws.html">Configuring for AWS</a></li>
            <li><a class="" href="../../install_config/configuring_openstack.html">Configuring for OpenStack</a></li>
            <li><a class="" href="../../install_config/configuring_gce.html">Configuring for GCE</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-13">
                <span id="sgSpan-4-13" class="fa fa-caret-right"></span>&nbsp;Configuring Persistent Storage
              </a>
              <ul id="topicSubGroup-4-13" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/persistent_storage/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_nfs.html">Using NFS</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_glusterfs.html">Using GlusterFS</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_cinder.html">Using OpenStack Cinder</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_ceph_rbd.html">Using Ceph RBD</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_aws.html">Using AWS Elastic Block Store</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_gce.html">Using GCE Persistent Disk</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_iscsi.html">Using iSCSI</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_fibre_channel.html">Using Fibre Channel</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/dynamically_provisioning_pvs.html">Dynamic Provisioning</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/pod_security_context.html">Volume Security</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-14">
                <span id="sgSpan-4-14" class="fa fa-caret-right"></span>&nbsp;Persistent Storage Examples
              </a>
              <ul id="topicSubGroup-4-14" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/storage_examples/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/storage_examples/shared_storage.html">Sharing an NFS PV Across Two Pods</a></li>
                  <li><a class="" href="../../install_config/storage_examples/ceph_example.html">Complete Example Using Ceph RBD</a></li>
                  <li><a class="" href="../../install_config/storage_examples/gluster_example.html">Complete Example Using GlusterFS</a></li>
                  <li><a class="" href="../../install_config/storage_examples/privileged_pod_storage.html">Mounting Volumes To Privileged Pods</a></li>
                  <li><a class="" href="../../install_config/storage_examples/gluster_backed_registry.html">Backing Docker Registry with GlusterFS Storage</a></li>
              </ul>
            </li>
            <li><a class="" href="../../install_config/http_proxies.html">Working with HTTP Proxies</a></li>
            <li><a class="" href="../../install_config/build_defaults_overrides.html">Configuring Global Build Defaults and Overrides</a></li>
            <li><a class="" href="../../install_config/configuring_pipeline_execution.html">Configuring Build Pipeline Execution</a></li>
            <li><a class="" href="../../install_config/native_container_routing.html">Native Container Routing</a></li>
            <li><a class="" href="../../install_config/routing_from_edge_lb.html">Routing from Edge Load Balancers</a></li>
            <li><a class="" href="../../install_config/aggregate_logging.html">Aggregating Container Logs</a></li>
            <li><a class="" href="../../install_config/cluster_metrics.html">Enabling Cluster Metrics</a></li>
            <li><a class="" href="../../install_config/web_console_customization.html">Customizing the Web Console</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>Cluster Administration
      </a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../../admin_guide/index.html">Overview</a></li>
            <li><a class="" href="../../admin_guide/manage_nodes.html">Managing Nodes</a></li>
            <li><a class="" href="../../admin_guide/manage_users.html">Managing Users</a></li>
            <li><a class="" href="../../admin_guide/managing_projects.html">Managing Projects</a></li>
            <li><a class="" href="../../admin_guide/service_accounts.html">Configuring Service Accounts</a></li>
            <li><a class="" href="../../admin_guide/manage_authorization_policy.html">Managing Authorization Policies</a></li>
            <li><a class="" href="../../admin_guide/scoped_tokens.html">Scoped Tokens</a></li>
            <li><a class="" href="../../admin_guide/manage_scc.html">Managing Security Context Constraints</a></li>
            <li><a class="" href="../../admin_guide/quota.html">Setting Quotas</a></li>
            <li><a class="" href="../../admin_guide/limits.html">Setting Limit Ranges</a></li>
            <li><a class="" href="../../admin_guide/pruning_resources.html">Pruning Objects</a></li>
            <li><a class="" href="../../admin_guide/garbage_collection.html">Garbage Collection</a></li>
            <li><a class="" href="../../admin_guide/scheduler.html">Scheduler</a></li>
            <li><a class="" href="../../admin_guide/allocating_node_resources.html">Allocating Node Resources</a></li>
            <li><a class="" href="../../admin_guide/overcommit.html">Overcommitting</a></li>
            <li><a class="" href="../../admin_guide/limit_runonce_pod_duration.html">Limit Run-once Pod Duration</a></li>
            <li><a class="" href="../../admin_guide/router.html">Monitoring Routers</a></li>
            <li><a class="" href="../../admin_guide/high_availability.html">High Availability</a></li>
            <li><a class="" href="../../admin_guide/pod_network.html">Managing Pod Networks</a></li>
            <li><a class="" href="../../admin_guide/iptables.html">IPtables</a></li>
            <li><a class="" href="../../admin_guide/securing_builds.html">Securing Builds by Strategy</a></li>
            <li><a class="" href="../../admin_guide/building_dependency_trees.html">Building Dependency Trees</a></li>
            <li><a class="" href="../../admin_guide/sdn_troubleshooting.html">Troubleshooting Networking</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6">
        <span id="tgSpan6" class="fa fa-angle-right"></span>CLI Reference
      </a>
      <ul id="topicGroup6" class="collapse  list-unstyled">
            <li><a class="" href="../../cli_reference/index.html">Overview</a></li>
            <li><a class="" href="../../cli_reference/get_started_cli.html">Get Started with the CLI</a></li>
            <li><a class="" href="../../cli_reference/manage_cli_profiles.html">Managing CLI Profiles</a></li>
            <li><a class="" href="../../cli_reference/basic_cli_operations.html">Developer CLI Operations</a></li>
            <li><a class="" href="../../cli_reference/admin_cli_operations.html">Administrator CLI Operations</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7">
        <span id="tgSpan7" class="fa fa-angle-right"></span>Developer Guide
      </a>
      <ul id="topicGroup7" class="collapse  list-unstyled">
            <li><a class="" href="../../dev_guide/index.html">Overview</a></li>
            <li><a class="" href="../../dev_guide/application_lifecycle.html">Application Life Cycle Examples</a></li>
            <li><a class="" href="../../dev_guide/authentication.html">Authentication</a></li>
            <li><a class="" href="../../dev_guide/projects.html">Projects</a></li>
            <li><a class="" href="../../dev_guide/new_app.html">Creating New Applications</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-7-5">
                <span id="sgSpan-7-5" class="fa fa-caret-right"></span>&nbsp;Application Tutorials
              </a>
              <ul id="topicSubGroup-7-5" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../dev_guide/app_tutorials/index.html">Overview</a></li>
                  <li><a class="" href="../../dev_guide/app_tutorials/quickstarts.html">Quickstart Templates</a></li>
                  <li><a class="" href="../../dev_guide/app_tutorials/ruby_on_rails.html">Ruby on Rails</a></li>
              </ul>
            </li>
            <li><a class="" href="../../dev_guide/ssh_environment.html">Opening a Remote Shell to Containers</a></li>
            <li><a class="" href="../../dev_guide/templates.html">Templates</a></li>
            <li><a class="" href="../../dev_guide/service_accounts.html">Service Accounts</a></li>
            <li><a class="" href="../../dev_guide/builds.html">Builds</a></li>
            <li><a class="" href="../../dev_guide/managing_images.html">Managing Images</a></li>
            <li><a class="" href="../../dev_guide/compute_resources.html">Quotas and Limit Ranges</a></li>
            <li><a class="" href="../../dev_guide/deployments.html">Deployments</a></li>
            <li><a class="" href="../../dev_guide/routes.html">Routes</a></li>
            <li><a class="" href="../../dev_guide/integrating_external_services.html">Integrating External Services</a></li>
            <li><a class="" href="../../dev_guide/secrets.html">Secrets</a></li>
            <li><a class="" href="../../dev_guide/configmaps.html">ConfigMaps</a></li>
            <li><a class="" href="../../dev_guide/pod_autoscaling.html">Pod Autoscaling</a></li>
            <li><a class="" href="../../dev_guide/volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../../dev_guide/persistent_volumes.html">Using Persistent Volumes</a></li>
            <li><a class="" href="../../dev_guide/executing_remote_commands.html">Executing Remote Commands</a></li>
            <li><a class="" href="../../dev_guide/copy_files_to_container.html">Copying Files</a></li>
            <li><a class="" href="../../dev_guide/port_forwarding.html">Port Forwarding</a></li>
            <li><a class="" href="../../dev_guide/shared_memory.html">Shared Memory</a></li>
            <li><a class="" href="../../dev_guide/application_health.html">Application Health</a></li>
            <li><a class="" href="../../dev_guide/events.html">Events</a></li>
            <li><a class="" href="../../dev_guide/downward_api.html">Downward API</a></li>
            <li><a class="" href="../../dev_guide/environment_variables.html">Managing Environment Variables</a></li>
            <li><a class="" href="../../dev_guide/jobs.html">Jobs</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup8">
        <span id="tgSpan8" class="fa fa-angle-right"></span>Creating Images
      </a>
      <ul id="topicGroup8" class="collapse  list-unstyled">
            <li><a class="" href="../../creating_images/index.html">Overview</a></li>
            <li><a class="" href="../../creating_images/guidelines.html">Guidelines</a></li>
            <li><a class="" href="../../creating_images/metadata.html">Image Metadata</a></li>
            <li><a class="" href="../../creating_images/s2i.html">S2I Requirements</a></li>
            <li><a class="" href="../../creating_images/s2i_testing.html">Testing S2I Images</a></li>
            <li><a class="" href="../../creating_images/custom.html">Custom Builder</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup9">
        <span id="tgSpan9" class="fa fa-angle-down"></span>Using Images
      </a>
      <ul id="topicGroup9" class="collapse in list-unstyled">
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-9-0">
                <span id="sgSpan-9-0" class="fa fa-caret-right"></span>&nbsp;Source-to-Image (S2I)
              </a>
              <ul id="topicSubGroup-9-0" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/s2i_images/index.html">Overview</a></li>
                  <li><a class="" href="../../using_images/s2i_images/nodejs.html">Node.js</a></li>
                  <li><a class="" href="../../using_images/s2i_images/ruby.html">Ruby</a></li>
                  <li><a class="" href="../../using_images/s2i_images/perl.html">Perl</a></li>
                  <li><a class="" href="../../using_images/s2i_images/php.html">PHP</a></li>
                  <li><a class="" href="../../using_images/s2i_images/python.html">Python</a></li>
                  <li><a class="" href="../../using_images/s2i_images/java.html">Java</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-9-1">
                <span id="sgSpan-9-1" class="fa fa-caret-down"></span>&nbsp;Database Images
              </a>
              <ul id="topicSubGroup-9-1" class="nav-tertiary list-unstyled collapse in">
                  <li><a class="" href="../../using_images/db_images/index.html">Overview</a></li>
                  <li><a class=" active" href="../../using_images/db_images/mysql.html">MySQL</a></li>
                  <li><a class="" href="../../using_images/db_images/postgresql.html">PostgreSQL</a></li>
                  <li><a class="" href="../../using_images/db_images/mongodb.html">MongoDB</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-9-2">
                <span id="sgSpan-9-2" class="fa fa-caret-right"></span>&nbsp;Docker Images
              </a>
              <ul id="topicSubGroup-9-2" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/docker_images/index.html">Overview</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-9-3">
                <span id="sgSpan-9-3" class="fa fa-caret-right"></span>&nbsp;Other Images
              </a>
              <ul id="topicSubGroup-9-3" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/other_images/index.html">Overview</a></li>
                  <li><a class="" href="../../using_images/other_images/jenkins.html">Jenkins</a></li>
              </ul>
            </li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup10">
        <span id="tgSpan10" class="fa fa-angle-right"></span>REST API Reference
      </a>
      <ul id="topicGroup10" class="collapse  list-unstyled">
            <li><a class="" href="../../rest_api/index.html">Overview</a></li>
            <li><a class="" href="../../rest_api/openshift_v1.html">OpenShift v1</a></li>
            <li><a class="" href="../../rest_api/kubernetes_v1.html">Kubernetes v1</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup11">
        <span id="tgSpan11" class="fa fa-angle-right"></span>OpenShift on AWS
      </a>
      <ul id="topicGroup11" class="collapse  list-unstyled">
            <li><a class="" href="../../scollier-aws/appendix.html">Appendix</a></li>
            <li><a class="" href="../../scollier-aws/ch1_execsummary.html">Executive Summary</a></li>
            <li><a class="" href="../../scollier-aws/ch2_ami.html">AMI Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_bastion.html">Bastion Host</a></li>
            <li><a class="" href="../../scollier-aws/ch2_components-and-configuration.html">Components and Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_dynamic_inventory.html">Dynami Inventory</a></li>
            <li><a class="" href="../../scollier-aws/ch2_google-oauth.html">Google Authentication</a></li>
            <li><a class="" href="../../scollier-aws/ch2_iam.html">IAM Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_load_balancers.html">Load Balancers</a></li>
            <li><a class="" href="../../scollier-aws/ch2_nat-gateway.html">NAT Gateway Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_nodes.html">Node Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_registry.html">Registry Conifguration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_route53.html">Route53 DNS Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_router.html">Router Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_s3.html">S3 Storage Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_security-groups.html">Security Groups</a></li>
            <li><a class="" href="../../scollier-aws/ch2_ssh.html">SSH Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch2_vpc.html">VPC Configuration</a></li>
            <li><a class="" href="../../scollier-aws/ch3_deploying-with-ansible.html">Deploy with Ansible</a></li>
            <li><a class="" href="../../scollier-aws/ch3_deploying-with-bash.html">Deploy with Bash</a></li>
            <li><a class="" href="../../scollier-aws/ch3_provision-infrastructure.html">Provision the Infrastructure</a></li>
            <li><a class="" href="../../scollier-aws/ch4_deploying-ose.html">Deploy OpenShift Container Platform</a></li>
            <li><a class="" href="../../scollier-aws/ch5_post-deployment-actions.html">Post Deployment Activities</a></li>
            <li><a class="" href="../../scollier-aws/ch6_operational-mgmt.html">Operational Management</a></li>
            <li><a class="" href="../../scollier-aws/ch7_conclusion.html">Conclustion</a></li>
            <li><a class="" href="../../scollier-aws/commentsfeedback.html">Feedback</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>MySQL</h2>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#overview">Overview</a></li>
<li><a href="#versions">Versions</a></li>
<li><a href="#images">Images</a></li>
<li><a href="#configuration-and-usage">Configuration and Usage</a>
<ul class="sectlevel2">
<li><a href="#initializing-the-database">Initializing the Database</a></li>
<li><a href="#running-mysql-commands-in-containers">Running MySQL Commands in Containers</a></li>
<li><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#volume-mount-points">Volume Mount Points</a></li>
<li><a href="#mysql-changing-passwords">Changing Passwords</a></li>
</ul>
</li>
<li><a href="#creating-a-database-service-from-a-template">Creating a Database Service from a Template</a></li>
<li><a href="#using-mysql-replication">Using MySQL Replication</a>
<ul class="sectlevel2">
<li><a href="#creating-the-deployment-configuration-for-mysql-master">Creating the Deployment Configuration for the MySQL Master</a></li>
<li><a href="#mysql-creating-headless-service">Creating a Headless Service</a></li>
<li><a href="#scaling-the-mysql-slaves">Scaling the MySQL Slaves</a></li>
</ul>
</li>
<li><a href="#troubleshooting">Troubleshooting</a>
<ul class="sectlevel2">
<li><a href="#linux-native-aio-failure">Linux Native AIO Failure</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Origin provides a Docker image for running MySQL. This image can
provide database services based on username, password, and database name
settings provided via configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="versions"><a class="anchor" href="#versions"></a>Versions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Currently, OpenShift Origin provides version
<a href="https://github.com/openshift/mysql/tree/master/5.5">5.5</a> and
<a href="https://github.com/openshift/mysql/tree/master/5.6">5.6</a> of MySQL.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="images"><a class="anchor" href="#images"></a>Images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This image comes in two flavors, depending on your needs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RHEL 7</p>
</li>
<li>
<p>CentOS 7</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>RHEL 7 Based Image</strong></p>
</div>
<div class="paragraph">
<p>The RHEL 7 image is available through Red Hat&#8217;s subscription registry via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ docker pull registry.access.redhat.com/openshift3/mysql-55-rhel7</pre>
</div>
</div>
<div class="paragraph">
<p><strong>CentOS 7 Based Image</strong></p>
</div>
<div class="paragraph">
<p>This image is available on DockerHub. To download it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ docker pull openshift/mysql-55-centos7</pre>
</div>
</div>
<div class="paragraph">
<p>To use these images, you can either access them directly from these
registries or push them into your OpenShift Origin Docker registry. Additionally,
you can create an ImageStream that points to the image,
either in your Docker registry or at the external location. Your OpenShift Origin
resources can then reference the ImageStream. You can find
<a href="https://github.com/openshift/origin/tree/master/examples/image-streams">example</a>
ImageStream definitions for all the provided OpenShift Origin images.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-and-usage"><a class="anchor" href="#configuration-and-usage"></a>Configuration and Usage</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="initializing-the-database"><a class="anchor" href="#initializing-the-database"></a>Initializing the Database</h3>
<div class="paragraph">
<p>The first time you use the shared volume, the database is created along with
the database administrator user and the MySQL root user (if you specify the
<code><strong>MYSQL_ROOT_PASSWORD</strong></code> environment variable).  Afterwards, the MySQL daemon
starts up. If you are re-attaching the volume to another container, then the
database, database user, and the administrator user are not created, and the
MySQL daemon starts.</p>
</div>
<div class="paragraph">
<p>The following command creates a new database
<a href="../../architecture/core_concepts/pods_and_services.html#pods">pod</a> with
MySQL running in a container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc new-app -e \
    MYSQL_USER=&lt;username&gt;,MYSQL_PASSWORD=&lt;password&gt;,MYSQL_DATABASE=&lt;database_name&gt; \
    openshift/mysql-55-centos7</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="running-mysql-commands-in-containers"><a class="anchor" href="#running-mysql-commands-in-containers"></a>Running MySQL Commands in Containers</h3>
<div class="paragraph">
<p>OpenShift Origin uses <a href="https://www.softwarecollections.org/">Software Collections</a>
(SCLs) to install and launch MySQL. If you want to execute a MySQL command
inside of a running container (for debugging), you must invoke it using bash.</p>
</div>
<div class="paragraph">
<p>To do so, first identify the name of the pod. For example, you can view the list
of pods in your current project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get pods</pre>
</div>
</div>
<div class="paragraph">
<p>Then, open a remote shell session to the pod:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc rsh &lt;pod&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>When you enter the container, the required SCL is automatically enabled.</p>
</div>
<div class="paragraph">
<p>You can now run the <strong>mysql</strong> command from the bash shell to start a MySQL
interactive session and perform normal MySQL operations. For example, to
authenticate as the database user:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">bash-4.2$ mysql -u $MYSQL_USER -p$MYSQL_PASSWORD -h $HOSTNAME $MYSQL_DATABASE
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 4
Server version: 5.5.37 MySQL Community Server (GPL)
...
mysql&gt;</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When you are finished, enter <strong>quit</strong> or <strong>exit</strong> to leave the MySQL session.</p>
</div>
</div>
<div class="sect2">
<h3 id="environment-variables"><a class="anchor" href="#environment-variables"></a>Environment Variables</h3>
<div class="paragraph">
<p>The MySQL user name, password, and database name must be configured with the
following environment variables:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. MySQL Environment Variables</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_USER</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specifies the user name for the database user that is created for use by your
application.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_PASSWORD</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Password for the <code><strong>MYSQL_USER</strong></code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_DATABASE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Name of the database to which <code><strong>MYSQL_USER</strong></code> has full rights.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_ROOT_PASSWORD</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional password for the root user. If this is not set, then remote login to
the root account is not possible. Local connections from within the container
are always permitted without a password.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_SERVICE_HOST</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Service host variable automatically created by Kubernetes.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_SERVICE_PORT</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Service port variable automatically created by Kubernetes.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must specify the user name, password, and database name. If you do not
specify all three, the pod will fail to start and OpenShift Origin will
continuously try to restart it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>MySQL settings can be configured with the following environment variables:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Additional MySQL Settings</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 60%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_LOWER_CASE_TABLE_NAMES</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Sets how the table names are stored and compared.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>0</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_MAX_CONNECTIONS</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The maximum permitted number of simultaneous client connections.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>151</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_MAX_ALLOWED_PACKET</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The maximum size of one packet or any generated/intermediate string.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>200M</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_FT_MIN_WORD_LEN</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The minimum length of the word to be included in a FULLTEXT index.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>4</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_FT_MAX_WORD_LEN</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The maximum length of the word to be included in a FULLTEXT index.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>20</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_AIO</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Controls the <strong>innodb_use_native_aio</strong> setting value if the native AIO is broken.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>1</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_TABLE_OPEN_CACHE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The number of open tables for all threads.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>400</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_KEY_BUFFER_SIZE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The size of the buffer used for index blocks.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>32M (or 10% of available memory)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_SORT_BUFFER_SIZE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The size of the buffer used for sorting.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>256K</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_READ_BUFFER_SIZE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The size of the buffer used for a sequential scan.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>8M (or 5% of available memory)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_INNODB_BUFFER_POOL_SIZE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The size of the buffer pool where InnoDB caches table and index data.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>32M (or 50% of available memory)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_INNODB_LOG_FILE_SIZE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The size of each log file in a log group.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>8M (or 15% of available memory)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_INNODB_LOG_BUFFER_SIZE</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The size of the buffer that InnoDB uses to write to the log files on disk.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>8M (or 15% of available memory)</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Some of the memory-related parameters have two default values. The fixed value
is used when a container does not have <a href="../../dev_guide/compute_resources.html#dev-memory-limits">memory limits</a>
assigned. The other value is calculated dynamically during a container&#8217;s startup
based on available memory.</p>
</div>
</div>
<div class="sect2">
<h3 id="volume-mount-points"><a class="anchor" href="#volume-mount-points"></a>Volume Mount Points</h3>
<div class="paragraph">
<p>The MySQL image can be run with mounted volumes to enable persistent storage for
the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><em>/var/lib/mysql/data</em></strong> - This is the data directory where MySQL stores
database files.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mysql-changing-passwords"><a class="anchor" href="#mysql-changing-passwords"></a>Changing Passwords</h3>
<div class="paragraph">
<p>Passwords are part of the image configuration, therefore the only supported
method to change passwords for the database user (<code><strong>MYSQL_USER</strong></code>) and <strong>root</strong>
user is by changing the environment variables <code><strong>MYSQL_PASSWORD</strong></code> and
<code><strong>MYSQL_ROOT_PASSWORD</strong></code>, respectively.</p>
</div>
<div class="paragraph">
<p>You can view the current passwords by viewing the pod or deployment
configuration in the web console or by listing the environment variables with
the CLI:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc env pod &lt;pod_name&gt; --list</pre>
</div>
</div>
<div class="paragraph">
<p>Whenever <code><strong>MYSQL_ROOT_PASSWORD</strong></code> is set, it enables remote access for the <strong>root</strong>
user with the given password, and whenever it is unset, remote access for the
<strong>root</strong> user is disabled. This does not affect the regular user <code><strong>MYSQL_USER</strong></code>,
who always has remote access. This also does not affect local access by the
<strong>root</strong> user, who can always log in without a password in <strong>localhost</strong>.</p>
</div>
<div class="paragraph">
<p>Changing database passwords through SQL statements or any way other than through
the environment variables aforementioned causes a mismatch between the values
stored in the variables and the actual passwords. Whenever a database container
starts, it resets the passwords to the values stored in the environment
variables.</p>
</div>
<div class="paragraph">
<p>To change these passwords, update one or both of the desired environment
variables for the related deployment configuration(s) using the <code>oc env</code>
command. If multiple deployment configurations utilize these environment
variables, for example in the case of an application created from a template,
you must update the variables on each deployment configuration so that the
passwords are in sync everywhere. This can be done all in the same command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc env dc &lt;dc_name&gt; [&lt;dc_name_2&gt; ...] \
  MYSQL_PASSWORD=&lt;new_password&gt; \
  MYSQL_ROOT_PASSWORD=&lt;new_root_password&gt;</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Depending on your application, there may be other environment variables for
passwords in other parts of the application that should also be updated to
match. For example, there could be a more generic <code><strong>DATABASE_USER</strong></code> variable in
a front-end pod that should match the database user&#8217;s password. Ensure that
passwords are in sync for all required environment variables per your
application, otherwise your pods may fail to redeploy when triggered.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Updating the environment variables triggers the redeployment of the database
server if you have a
<a href="../../dev_guide/deployments.html#config-change-trigger">configuration change
trigger</a>. Otherwise, you must manually start a new deployment in order to apply
the password changes.</p>
</div>
<div class="paragraph">
<p>To verify that new passwords are in effect, first open a remote shell session to
the running MySQL pod:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc rsh &lt;pod&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>From the bash shell, verify the database user&#8217;s new password:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">bash-4.2$ mysql -u $MYSQL_USER -p&lt;new_password&gt; -h $HOSTNAME $MYSQL_DATABASE -te "SELECT * FROM (SELECT database()) db CROSS JOIN (SELECT user()) u"</pre>
</div>
</div>
<div class="paragraph">
<p>If the password was changed correctly, you should see a table like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">+------------+---------------------+
| database() | user()              |
+------------+---------------------+
| sampledb   | user0PG@172.17.42.1 |
+------------+---------------------+</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>To verify the <strong>root</strong> user&#8217;s new password:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">bash-4.2$ mysql -u root -p&lt;new_root_password&gt; -h $HOSTNAME $MYSQL_DATABASE -te "SELECT * FROM (SELECT database()) db CROSS JOIN (SELECT user()) u"</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the password was changed correctly, you should see a table like this:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">+------------+------------------+
| database() | user()           |
+------------+------------------+
| sampledb   | root@172.17.42.1 |
+------------+------------------+</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-database-service-from-a-template"><a class="anchor" href="#creating-a-database-service-from-a-template"></a>Creating a Database Service from a Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenShift Origin provides a <a href="../../dev_guide/templates.html#dev-guide-templates">template</a> to make
creating a new database service easy. The template provides parameter fields to
define all the mandatory environment variables (user, password, database name,
etc) with predefined defaults including auto-generation of password values. It
will also define both a
<a href="../../architecture/core_concepts/deployments.html#deployments-and-deployment-configurations">deployment
configuration</a> and a
<a href="../../architecture/core_concepts/pods_and_services.html#services">service</a>.</p>
</div>
<div class="paragraph">
<p>The MySQL templates should have been registered in the default <strong>openshift</strong>
project by your cluster administrator during the initial cluster setup.
See <a href="../../install_config/imagestreams_templates.html#install-config-imagestreams-templates">Loading the Default Image Streams and Templates</a>
for more details, if required.</p>
</div>
<div class="paragraph">
<p>There are two templates available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mysql-ephemeral</code> is for development or testing purposes only because it uses
ephemeral storage for the database content. This means that if the database
pod is restarted for any reason, such as the pod being moved to another node
or the deployment configuration being updated and triggering a redeploy, all
data will be lost.</p>
</li>
<li>
<p><code>mysql-persistent</code> uses a persistent volume store for the database data which
means the data will survive a pod restart. Using persistent volumes requires a
persistent volume pool be defined in the OpenShift Origin deployment.
Cluster administrator instructions for setting up the pool are located
<a href="../../install_config/persistent_storage/persistent_storage_nfs.html#install-config-persistent-storage-persistent-storage-nfs">here</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find instructions for instantiating templates by following these
<a href="../../dev_guide/templates.html#dev-guide-templates">instructions</a>.</p>
</div>
<div class="paragraph">
<p>Once you have instantiated the service, you can copy the user name, password,
and database name environment variables into a deployment configuration for
another component that intends to access the database. That component can then
access the database via the service that was defined.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-mysql-replication"><a class="anchor" href="#using-mysql-replication"></a>Using MySQL Replication</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Replication support provided by the MySQL image is experimental and should not
be used in production.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Red Hat provides a proof-of-concept
<a href="../../architecture/core_concepts/templates.html#architecture-core-concepts-templates">template</a> for MySQL
master-slave replication (clustering); you can obtain the
<a href="https://github.com/openshift/mysql/tree/master/5.5/examples/replica">example
template from GitHub</a>.</p>
</div>
<div class="paragraph">
<p>To upload the example template into the current project&#8217;s template library:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc create -f \
    https://raw.githubusercontent.com/openshift/mysql/master/5.5/examples/replica/mysql_replica.json</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The following sections detail the objects defined in the example template and
describe how they work together to start a cluster of MySQL servers implementing
master-slave replication. This is the recommended replication strategy for
MySQL.</p>
</div>
<div class="sect2">
<h3 id="creating-the-deployment-configuration-for-mysql-master"><a class="anchor" href="#creating-the-deployment-configuration-for-mysql-master"></a>Creating the Deployment Configuration for the MySQL Master</h3>
<div class="paragraph">
<p>To set up MySQL replication, a
<a href="../../architecture/core_concepts/deployments.html#deployments-and-deployment-configurations">deployment
configuration</a> is defined in the example template that defines a
<a href="../../architecture/core_concepts/deployments.html#replication-controllers">replication
controller</a>. For MySQL master-slave replication, two deployment configurations
are needed. One deployment configuration defines the MySQL <em>master</em> server and
second the MySQL <em>slave</em> servers.</p>
</div>
<div class="paragraph">
<p>To tell a MySQL server to act as the master, the <code><strong>command</strong></code> field in the
container&#8217;s definition in the deployment configuration must be set to
<strong>run-mysqld-master</strong>. This script acts as an alternative entrypoint for the
MySQL image and configures the MySQL server to run as the master in replication.</p>
</div>
<div class="paragraph">
<p>MySQL replication requires a special user that relays data between the master
and slaves. The following environment variables are defined in the template for
this purpose:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 30%;">
<col style="width: 60%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_MASTER_USER</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The user name of the replication user</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><strong>master</strong></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code><strong>MYSQL_MASTER_PASSWORD</strong></code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The password for the replication user</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><strong>generated</strong></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="exampleblock">
<div class="title">Example 1. MySQL Master Deployment Configuration Object Definition in the Example Template</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DeploymentConfig</span><span style="color:#710">&quot;</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">v1</span><span style="color:#710">&quot;</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">strategy</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Recreate</span><span style="color:#710">&quot;</span></span>
  <span style="color:#606">triggers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: &quot;ConfigChange&quot;</span></span>
  <span style="color:#606">replicas</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
  <span style="color:#606">selector</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
  <span style="color:#606">template</span>:
    <span style="color:#606">metadata</span>:
      <span style="color:#606">labels</span>:
        <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
    <span style="color:#606">spec</span>:
      <span style="color:#606">volumes</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;mysql-master-data&quot;</span></span>
          <span style="color:#606">persistentVolumeClaim</span>:
            <span style="color:#606">claimName</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">containers</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;server&quot;</span></span>
          <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">openshift/mysql-55-centos7</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">command</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">run-mysqld-master</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">ports</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">containerPort: 3306</span></span>
              <span style="color:#606">protocol</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TCP</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">env</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_MASTER_USER&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_MASTER_USER}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_MASTER_PASSWORD&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_MASTER_PASSWORD}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_USER&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_USER}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_PASSWORD&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_PASSWORD}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_DATABASE&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_DATABASE}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_ROOT_PASSWORD&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_ROOT_PASSWORD}</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">volumeMounts</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;mysql-master-data&quot;</span></span>
              <span style="color:#606">mountPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/var/lib/mysql/data</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">resources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">{}</span></span>
          <span style="color:#606">terminationMessagePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/dev/termination-log</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">IfNotPresent</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">securityContext</span>:
            <span style="color:#606">capabilities</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">{}</span></span>
            <span style="color:#606">privileged</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">false</span></span>
      <span style="color:#606">restartPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Always</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">dnsPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ClusterFirst</span><span style="color:#710">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Since we claimed a persistent volume in this deployment configuration to have
all data persisted for the MySQL master server, you must ask your cluster
administrator to create a persistent volume that you can claim the storage from.</p>
</div>
<div class="paragraph">
<p>After the deployment configuration is created and the pod with MySQL master
server is started, it will create the database defined by <code><strong>MYSQL_DATABASE</strong></code> and
configure the server to replicate this database to slaves.</p>
</div>
<div class="paragraph">
<p>The example provided defines only one replica of the MySQL master server. This
causes OpenShift Originto start only one instance of the server. Multiple
instances (multi-master) is not supported and therefore you can not scale this
replication controller.</p>
</div>
<div id="creating-the-mysql-slaves" class="paragraph">
<p>To replicate the database created by the
<a href="#creating-the-deployment-configuration-for-mysql-master">MySQL master</a>, a
deployment configuration is defined in the template. This deployment
configuration creates a replication controller that launches the MySQL image
with the <code><strong>command</strong></code> field set to <strong>run-mysqld-slave</strong>. This alternative
entrypoints skips the initialization of the database and configures the MySQL
server to connect to the <strong>mysql-master</strong> service, which is also defined in
example template.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. MySQL Slave Deployment Configuration Object Definition in the Example Template</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="yaml"><span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DeploymentConfig</span><span style="color:#710">&quot;</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">v1</span><span style="color:#710">&quot;</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-slave</span><span style="color:#710">&quot;</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">strategy</span>:
    <span style="color:#606">type</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Recreate</span><span style="color:#710">&quot;</span></span>
  <span style="color:#606">triggers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">type: &quot;ConfigChange&quot;</span></span>
  <span style="color:#606">replicas</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">1</span></span>
  <span style="color:#606">selector</span>:
    <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-slave</span><span style="color:#710">&quot;</span></span>
  <span style="color:#606">template</span>:
    <span style="color:#606">metadata</span>:
      <span style="color:#606">labels</span>:
        <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-slave</span><span style="color:#710">&quot;</span></span>
    <span style="color:#606">spec</span>:
      <span style="color:#606">containers</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;server&quot;</span></span>
          <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">openshift/mysql-55-centos7</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">command</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">run-mysqld-slave</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">ports</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">containerPort: 3306</span></span>
              <span style="color:#606">protocol</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TCP</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">env</span>:
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_MASTER_USER&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_MASTER_USER}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_MASTER_PASSWORD&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_MASTER_PASSWORD}</span><span style="color:#710">&quot;</span></span>
            - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;MYSQL_DATABASE&quot;</span></span>
              <span style="color:#606">value</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${MYSQL_DATABASE}</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">resources</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">{}</span></span>
          <span style="color:#606">terminationMessagePath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/dev/termination-log</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">imagePullPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">IfNotPresent</span><span style="color:#710">&quot;</span></span>
          <span style="color:#606">securityContext</span>:
            <span style="color:#606">capabilities</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">{}</span></span>
            <span style="color:#606">privileged</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">false</span></span>
      <span style="color:#606">restartPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Always</span><span style="color:#710">&quot;</span></span>
      <span style="color:#606">dnsPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ClusterFirst</span><span style="color:#710">&quot;</span></span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This example deployment configuration starts the replication controller with the
initial number of replicas set to <strong>1</strong>. You can
<a href="#scaling-the-mysql-slaves">scale this replication controller</a> in both
directions, up to the resources capacity of your account.</p>
</div>
<div class="paragraph">
<p>If either the master or any of the slaves goes down, OpenShift Origin will bring them
back up. The master will reuse the persistent volume, while any restarted slaves
will replicate data from the master.</p>
</div>
</div>
<div class="sect2">
<h3 id="mysql-creating-headless-service"><a class="anchor" href="#mysql-creating-headless-service"></a>Creating a Headless Service</h3>
<div class="paragraph">
<p>The pods created by the MySQL slave replication controller must reach the MySQL
master server in order to register for replication. The example template defines
a headless service named <strong>mysql-master</strong> for this purpose. This service is not
used only for replication, but the clients can also send the queries to
<strong>mysql-master:3306</strong> as the MySQL host.</p>
</div>
<div class="paragraph">
<p>To have a headless service, the <code><strong>portalIP</strong></code> parameter in the service definition
is set to <strong>None</strong>. Then you can use a DNS query to get a list of the pod IP
addresses that represents the current endpoints for this service.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Headless Service Object Definition in the Example Template</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="json"><span style="color:#F00;background-color:#FAA">k</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">d</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Service</span><span style="color:#710">&quot;</span></span>
<span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">V</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">n</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">v1</span><span style="color:#710">&quot;</span></span>
<span style="color:#F00;background-color:#FAA">m</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span>:
  <span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">m</span><span style="color:#F00;background-color:#FAA">e</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
  <span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">b</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">s</span>:
    <span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">m</span><span style="color:#F00;background-color:#FAA">e</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
<span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">c</span>:
  <span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">s</span>:
    <span style="color:#F00;background-color:#FAA">-</span> <span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">c</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">l</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TCP</span><span style="color:#710">&quot;</span></span>
      <span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">t</span>: <span style="color:#00D">3306</span>
      <span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">g</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">P</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">t</span>: <span style="color:#00D">3306</span>
      <span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">P</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">t</span>: <span style="color:#00D">0</span>
  <span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">c</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span>:
    <span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">m</span><span style="color:#F00;background-color:#FAA">e</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mysql-master</span><span style="color:#710">&quot;</span></span>
  <span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">r</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">I</span><span style="color:#F00;background-color:#FAA">P</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">None</span><span style="color:#710">&quot;</span></span>
  <span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">y</span><span style="color:#F00;background-color:#FAA">p</span><span style="color:#F00;background-color:#FAA">e</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ClusterIP</span><span style="color:#710">&quot;</span></span>
  <span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">A</span><span style="color:#F00;background-color:#FAA">f</span><span style="color:#F00;background-color:#FAA">f</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">i</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">y</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">None</span><span style="color:#710">&quot;</span></span>
<span style="color:#F00;background-color:#FAA">s</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">t</span><span style="color:#F00;background-color:#FAA">u</span><span style="color:#F00;background-color:#FAA">s</span>:
  <span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">o</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">d</span><span style="color:#F00;background-color:#FAA">B</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">l</span><span style="color:#F00;background-color:#FAA">a</span><span style="color:#F00;background-color:#FAA">n</span><span style="color:#F00;background-color:#FAA">c</span><span style="color:#F00;background-color:#FAA">e</span><span style="color:#F00;background-color:#FAA">r</span>: {}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="scaling-the-mysql-slaves"><a class="anchor" href="#scaling-the-mysql-slaves"></a>Scaling the MySQL Slaves</h3>
<div class="paragraph">
<p>To <a href="../../dev_guide/deployments.html#scaling">increase the number of members</a>
in the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale rc mysql-slave-1 --replicas=&lt;number&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This tells <a href="#creating-the-deployment-configuration-for-mysql-master">the replication controller</a> to
create a new MySQL slave pod. When a new slave is created, the slave entrypoint
first attempts to contact the <strong>mysql-master</strong> service and register itself to the
replication set. Once that is done, the MySQL master server sends the slave the
replicated database.</p>
</div>
<div class="paragraph">
<p>When scaling down, the MySQL slave is shut down and, because the slave does not
have any persistent storage defined, all data on the slave is lost. The MySQL
master server then discovers that the slave is not reachable anymore, and it
automatically removes it from the replication.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a>Troubleshooting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes some troubles you might encounter
and presents possible resolutions.</p>
</div>
<div class="sect2">
<h3 id="linux-native-aio-failure"><a class="anchor" href="#linux-native-aio-failure"></a>Linux Native AIO Failure</h3>
<div class="paragraph">
<div class="title">Symptom</div>
<p>The MySQL container fails to start and the logs show something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">151113  5:06:56 InnoDB: Using Linux native AIO
151113  5:06:56  InnoDB: Warning: io_setup() failed with EAGAIN. Will make 5 attempts before giving up.
InnoDB: Warning: io_setup() attempt 1 failed.
InnoDB: Warning: io_setup() attempt 2 failed.
Waiting for MySQL to start ...
InnoDB: Warning: io_setup() attempt 3 failed.
InnoDB: Warning: io_setup() attempt 4 failed.
Waiting for MySQL to start ...
InnoDB: Warning: io_setup() attempt 5 failed.
151113  5:06:59  InnoDB: Error: io_setup() failed with EAGAIN after 5 attempts.
InnoDB: You can disable Linux Native AIO by setting innodb_use_native_aio = 0 in my.cnf
151113  5:06:59 InnoDB: Fatal error: cannot initialize AIO sub-system
151113  5:06:59 [ERROR] Plugin 'InnoDB' init function returned error.
151113  5:06:59 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGINE failed.
151113  5:06:59 [ERROR] Unknown/unsupported storage engine: InnoDB
151113  5:06:59 [ERROR] Aborting</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Explanation</div>
<p>MySQL&#8217;s storage engine was unable to use the kernel&#8217;s
AIO (Asynchronous I/O) facilities due to resource limits.</p>
</div>
<div class="olist arabic">
<div class="title">Resolution</div>
<ol class="arabic">
<li>
<p>Turn off AIO usage entirely,
by setting environment variable <code><strong>MYSQL_AIO</strong></code> to have value <code>0</code>.
On subsequent deployments, this arranges for the
MySQL configuration variable <code><strong>innodb_use_native_aio</strong></code>
to have value <code>0</code>.</p>
</li>
<li>
<p>Increase the <code>aio-max-nr</code> kernel resource.
The following example examines the current value of <code>aio-max-nr</code> and doubles it.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ sysctl fs.aio-max-nr
fs.aio-max-nr = 1048576
# sysctl -w fs.aio-max-nr=2097152</pre>
</div>
</div>
<div class="paragraph">
<p>This is a per-node resolution and lasts until the next node reboot.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
    <footer class="footer-origin-docs">
  <div class="container">
    <div class="row">
      <div class="col-sm-12">
        <div id="footer_social">
          <a href="https://twitter.com/openshift" class="first">
            <span>
              <i class="fa fa-twitter-square fa-2x fa-inverse"></i>
            </span>
          </a>
          <a href="https://github.com/openshift/origin">
            <span>
              <i class="fa fa-github fa-2x fa-inverse"></i>
            </span>
          </a>
          <a href="https://plus.google.com/communities/114361859072744017486">
            <span>
              <i class="fa fa-google-plus-square fa-2x fa-inverse"></i>
            </span>
          </a>
          <a href="https://www.facebook.com/openshift">
            <span>
              <i class="fa fa-facebook-square fa-2x fa-inverse"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 col-sm-4">
        <a id="footer_logo" href="https://www.redhat.com/">
          <img alt="Red Hat" src="https://assets.openshift.net/app/assets/redhat.svg">
        </a>
      </div>
      <div class="col-xs-12 col-sm-4 text-center">
        <a id="powered_by_openshift" title="Powered by OpenShift Online with the DIY Cartridge" href="https://hub.openshift.com/quickstarts/92-do-it-yourself-0-1">
          <img src="https://www.openshift.com/sites/default/files/images/powered-transparent-white.png" alt="Powered by OpenShift Online">
        </a>
      </div>
      <div class="col-xs-12 col-sm-4 text-right">
        <a id="built_with_asciibinder" title="Built with AsciiBinder docs management system" href="http://asciibinder.org/">
          <img src="../../../scollier-test/_images/asciibinder_web_logo.svg" alt="AsciiBinder">
        </a>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <div class="attribution">
          <button type="button" class="btn btn-link" data-html="true" data-container="body" data-toggle="popover" data-placement="top" data-content="
            '<a target='_blank' href='https://www.flickr.com/photos/eflon/3655695161/'>Spin</a>' by <a target='_blank' href='https://www.flickr.com/photos/eflon/'>eflon</a>,</br> used under <a target='_blank' href='https://creativecommons.org/licenses/by/2.0/'>CC BY 2.0</a> </br>Color tint added to original">
            Image attribution
          </button>
        </div>
      </div>
    </div>
    <script>
    $(function () {
      $('[data-toggle="popover"]').popover()
    })
    </script>
  </div>
</footer>
</body>
</html>