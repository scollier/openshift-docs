<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>OpenShift Enterprise Branch Build | Installation and Configuration | Upgrading | Manual Upgrades</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css">
  <link href="../../../scollier-test/_stylesheets/docs.css" rel="stylesheet" />
  <link href="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" type="image/png">
  <link href="https://assets.openshift.net/content/subdomain/favicon32x32.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://assets.openshift.net/content/subdomain/touch-icon-precomposed.png" name="msapplication-TileImage">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://assets.openshift.net/content/html5shiv.js" type="text/javascript"></script>
    <script src="https://assets.openshift.net/content/respond.js" type="text/javascript"></script>
    <link href="https://assets.openshift.net/content/vendor/respond-js/respond-proxy.html" id="respond-proxy" rel="respond-proxy">
    <link href="../../../scollier-test/_images/respond.proxy.gif" id="respond-redirect" rel="respond-redirect">
    <script src="../../../scollier-test/_javascripts/respond.proxy.js" type="text/javascript"></script>
  <![endif]-->
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="../../../scollier-test/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script type="text/javascript" src="https://assets.openshift.net/app/assets/site/tracking.js"></script>
</head>
<body>
  <div class="navbar navbar-default navbar-openshift" role="navigation">
  <div class="navbar-header">
    <div class="dropdown">
      <a href="#" class="dropdown-toggle navbar-menu-toggle" data-toggle="dropdown">
        <span class="navbar-menu-title">MENU</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <ul class="dropdown-menu navbar-menu" role="menu">
        <li class="submenu">
          <a href="#">Overview</a>
          <ul id="submenu-overview" class="dropdown-submenu">
            <li class="submenu-heading">Introduction to OpenShift</li>
            <li>
              <a href="https://www.openshift.com/about/index.html">
                What is OpenShift?
                <span class="submenu-item-desc">Learn about Red Hat's next-generation cloud application platform.</span>
              </a>
            </li>
            <li>
              <a href="https://enterprise.openshift.com/customers">
                Our Customers
                <span class="submenu-item-desc">Discover what companies are using OpenShift to deliver a flexible, scalable cloud applicaiton environtment.</span>
              </a>
            </li>
            <li class="submenu-heading">News</li>
            <li>
              <a href="https://www.openshift.com/about/awards.html">
                Awards
                <span class="submenu-item-desc">Industry recognition and awards.</span>
              </a>
            </li>
            <li>
              <a href="https://blog.openshift.com/">
                OpenShift Blog
                <span class="submenu-item-desc">Keep your finger on the pulse of all things OpenShift.</span>
              </a>
            </li>
            <li>
              <a href="https://blog.openshift.com/category/events/">
                Events
                <span class="submenu-item-desc">OpenShift sponsors and attends a variety of in-person events around the globe.</span>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/about/press.html">
                In the Press
                <span class="submenu-item-desc">The latest OpenShift news and press releases.</span>
              </a>
            </li>
            <li class="submenu-divider"></li>
            <li>
              <a href="http://jobs.redhat.com/job-search-results/?keywords=openshift">
                Careers <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/about/logos.html">
                Logos &amp; Media
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Features</a>
          <ul id="submenu-features" class="dropdown-submenu">
            <li class="submenu-heading">OpenShift Online</li>
            <li>
              <a href="https://www.openshift.com/features/index.html">
                Overview
                <span class="submenu-item-desc">Quickly develop, host, and scale applications in the public cloud with on-demand access.</span>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/pricing/index.html">
                Plans &amp; Pricing
                <span class="submenu-item-desc">Host up to 3 apps for free. Upgrade and add production gears, extra storage, and more.</span>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/app/account/new">
                Sign up for Free
              </a>
            </li>
            <li class="submenu-heading">OpenShift Dedicated</li>
            <li>
              <a href="https://www.openshift.com/dedicated/index.html">
                Overview
                <span class="submenu-item-desc">Your own private OpenShift cluster, operated by Red Hat.</span>
              </a>
            </li>
            <li class="submenu-heading">OpenShift Enterprise</li>
            <li>
              <a href="https://enterprise.openshift.com/">
                Overview
                <span class="submenu-item-desc">Accelerate application delivery with the speed and consistency that business demands.</span>
              </a>
            </li>
            <li>
              <a href="https://enterprise.openshift.com/resources/index.html">
                Resources
                <span class="submenu-item-desc">Webinars, datasheets, reference architectures, demo videos and more.</span>
              </a>
            </li>
            <li>
              <a href="https://enterprise.openshift.com/trial.html">
                Try it for Free
              </a>
            </li>
            <li class="submenu-divider"></li>
            <li>
              <a href="https://www.openshift.com/showcase/index.html">
                Application Gallery
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Developers</a>
          <ul id="submenu-developers" class="dropdown-submenu">
            <li>
              <a href="https://developers.openshift.com/en/getting-started-overview.html">
                Getting Started
                <span class="submenu-item-desc">New to OpenShift? Get your first application up and running and learn the basics.</span>
              </a>
            </li>
            <li>
              <a href="https://hub.openshift.com/">
                Hub
                <span class="submenu-item-desc">Find languages, frameworks, databases, and add-on services for OpenShift.</span>
              </a>
            </li>
            <li>
              <a href="https://developers.openshift.com/">
                Developer Portal
                <span class="submenu-item-desc">Learn about building, deploying, and managing your applications.</span>
              </a>
            </li>
            <li>
              <a href="https://docs.openshift.com/">
                Documentation
              </a>
            </li>
            <li class="submenu-divider"></li>
            <li>
              <a href="http://stackoverflow.com/questions/tagged/openshift">
                Stack Overflow
                <span class="submenu-item-desc">A Q&amp;A site for everything development related. Post a question or browse answers on the 'openshift' tag.</span>
              </a>
            </li>
            <li>
              <a href="https://enterprise.openshift.com/resources/index.html#training">
                Training &amp; Certification
                <span class="submenu-item-desc">Red Hat Training's hands-on, task-focused courses and certifications for IT professionals and developers.</span>
              </a>
            </li>
            <li class="submenu-divider"></li>
            <li>
              <a href="https://www.openshift.com/showcase/index.html">
                Application Gallery
                <span class="submenu-item-desc">Our showcase of applications running on OpenShift Online.</span>
              </a>
            </li>
            <li>
              <a href="http://www.openshift.org/#contribute">
                Contribute to OpenShift <i class="fa fa-external-link pull-right"></i>
                <span class="submenu-item-desc">Get in touch with our product team, or become a part of the OpenShift Origin open source project.</span>
              </a>
            </li>
            <li>
              <a href="https://openshift.uservoice.com/">
                Vote on Features
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Partners</a>
          <ul id="submenu-partners" class="dropdown-submenu">
            <li>
              <a href="https://www.openshift.com/partners/index.html">
                Become a Partner
                <span class="submenu-item-desc">Build on the strength of the world's leading open source company.</span>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/partners/index.html">
                Find OpenShift Partners
                <span class="submenu-item-desc">Find qualified partners to help you with your OpenShift projects.</span>
              </a>
            </li>
            <li class="submenu-divider"></li>
            <li>
              <a href="http://commons.openshift.org/">
                OpenShift Commons <i class="fa fa-external-link pull-right"></i>
                <span class="submenu-item-desc">Where users, partners, customers, and contributors come together to collaborate on OpenShift.</span>
              </a>
            </li>
            <li class="submenu-divider"></li>
            <li>
              <a href="https://www.openshift.com/grants/index.html">
                Resource Grants
                <span class="submenu-item-desc">For non-profits, educational institutions, and open source initiatives.</span>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/startups/index.html">
                Startup Program
                <span class="submenu-item-desc">Designed to help startups build and scale.</span>
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Support</a>
          <ul id="submenu-support" class="dropdown-submenu">
            <li>
              <a href="https://access.redhat.com/">
                Red Hat Customer Portal <i class="fa fa-external-link pull-right"></i>
                <span class="submenu-item-desc">Manage support cases, browse Knowledgebase articles, and more.</span>
              </a>
            </li>
            <li>
              <a href="https://docs.openshift.com/">
                Documentation
                <span class="submenu-item-desc">Official product documentation from Red Hat.</span>
              </a>
            </li>
            <li>
              <a href="https://help.openshift.com/">
                Help Center
                <span class="submenu-item-desc">The fastest way to find your available support options.</span>
              </a>
            </li>
            <li>
              <a href="http://stackoverflow.com/questions/tagged/openshift">
                Stack Overflow <i class="fa fa-external-link pull-right"></i>
                <span class="submenu-item-desc">A Q&amp;A site for everything development related. Post a question or browse answers on the 'openshift' tag.</span>
              </a>
            </li>
            <li>
              <a href="https://openshift.redhat.com/app/status">
                System Status <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.openshift.com/about/contact.html">
                Contact Us
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Connect</a>
          <ul id="submenu-connect" class="dropdown-submenu">
            <li>
              <a href="https://blog.openshift.com/">
                Blog
              </a>
            </li>
            <li>
              <a href="https://blog.openshift.com/category/events/">
                Events &amp; Conferences
              </a>
            </li>
            <li>
              <a href="http://commons.openshift.org/">
                OpenShift Commons <i class="fa fa-external-link pull-right"></i>
                <span class="submenu-item-desc">Where users, partners, customers, and contributors come together to collaborate on OpenShift.</span>
              </a>
            </li>
            <li>
              <a href="https://twitter.com/openshift">
                Twitter <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.facebook.com/openshift">
                Facebook <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.linkedin.com/grp/home?gid=4185734">
                LinkedIn <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://github.com/openshift/">
                GitHub <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://plus.google.com/+OpenShift">
                Google+ <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.youtube.com/user/rhopenshift">
                YouTube <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
          </ul>
        </li>
        <li>
          <a href="https://www.openshift.com/about/contact.html">
            Contact Us
          </a>
        </li>
        <li>
          <form action="https://help.openshift.com/hc/en-us/search" method="get" id="cse-search-form">
            <input name="query" id="cse-search-input" class="navbar-search-query form-control" type="text" placeholder="Search" tabindex="1" autocomplete="off" autofocus>
            <button type="submit" class="btn btn-default fa fa-search" value="Search"></button>
          </form>
        </li>
      </ul>
    </div>
    <a class="navbar-brand" href="/"></a>
  </div>
  <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="hidden-xs dropdown"> <a href="#" class="dropdown-toggle nav-log-in" data-toggle="dropdown"> My Account<span class="caret"></span> </a>
        <ul class="dropdown-menu">
          <li><a href="https://openshift.redhat.com/app/console">OpenShift Web Console</a></li>
          <li><a href="https://console.preview.openshift.com/">(Next Gen) Web Console</a></li>
          <li><a href="https://hub.openshift.com/users/auth/github">OpenShift Hub</a></li>
        </ul>
      </li>
      <li class="hidden-xs hidden-sm"><a class="nav-sign-up" href="https://www.openshift.com/app/account/new">Sign up for Free</a></li>
    </ul>
  </div>
</div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../../index.html">Documentation</a>
      </li>
      <li class="hidden-xs active">
        <a href="../../welcome/index.html">OpenShift Enterprise Branch Build</a>
      </li>
      <li class="hidden-xs active">
        <a href="../../install_config/index.html">Installation and Configuration</a>
      </li>
      <li class="hidden-xs active"><a href="../../install_config/upgrading/index.html">Upgrading</a></li>
      <li class="hidden-xs active">
        Manual Upgrades
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <div class="row-fluid">
          <script>
  (function() {
    var cx = '013769182564158614814:e-dp46b51vk';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search defaultToRefinement="Enterprise Branch Build"></gcse:search>
        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>About
      </a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../../welcome/index.html">Welcome</a></li>
            <li><a class="" href="../../welcome/revhistory_all.html">All Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>Release Notes
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../../release_notes/index.html">Overview</a></li>
            <li><a class="" href="../../release_notes/ose_3_2_release_notes.html">OpenShift Enterprise 3.2 Release Notes</a></li>
            <li><a class="" href="../../release_notes/xpaas_release_notes.html">xPaaS Release Notes</a></li>
            <li><a class="" href="../../release_notes/v2_vs_v3.html">Comparing OpenShift Enterprise 2 and OpenShift Enterprise 3</a></li>
            <li><a class="" href="../../release_notes/revhistory_release_notes.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>Getting Started
      </a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../../getting_started/index.html">Overview</a></li>
            <li><a class="" href="../../getting_started/developers_console.html">Web Console Walkthrough</a></li>
            <li><a class="" href="../../getting_started/administrators.html">Setting Up a Cluster</a></li>
            <li><a class="" href="../../getting_started/revhistory_getting_started.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>Architecture
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../../architecture/index.html">Overview</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-1">
                <span id="sgSpan-3-1" class="fa fa-caret-right"></span>&nbsp;Infrastructure Components
              </a>
              <ul id="topicSubGroup-3-1" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../architecture/infrastructure_components/kubernetes_infrastructure.html">Kubernetes Infrastructure</a></li>
                  <li><a class="" href="../../architecture/infrastructure_components/image_registry.html">Image Registry</a></li>
                  <li><a class="" href="../../architecture/infrastructure_components/web_console.html">Web Console</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-2">
                <span id="sgSpan-3-2" class="fa fa-caret-right"></span>&nbsp;Core Concepts
              </a>
              <ul id="topicSubGroup-3-2" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../architecture/core_concepts/index.html">Overview</a></li>
                  <li><a class="" href="../../architecture/core_concepts/containers_and_images.html">Containers and Images</a></li>
                  <li><a class="" href="../../architecture/core_concepts/pods_and_services.html">Pods and Services</a></li>
                  <li><a class="" href="../../architecture/core_concepts/projects_and_users.html">Projects and Users</a></li>
                  <li><a class="" href="../../architecture/core_concepts/builds_and_image_streams.html">Builds and Image Streams</a></li>
                  <li><a class="" href="../../architecture/core_concepts/deployments.html">Deployments</a></li>
                  <li><a class="" href="../../architecture/core_concepts/routes.html">Routes</a></li>
                  <li><a class="" href="../../architecture/core_concepts/templates.html">Templates</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-3-3">
                <span id="sgSpan-3-3" class="fa fa-caret-right"></span>&nbsp;Additional Concepts
              </a>
              <ul id="topicSubGroup-3-3" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../architecture/additional_concepts/networking.html">Networking</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/sdn.html">OpenShift SDN</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/authentication.html">Authentication</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/authorization.html">Authorization</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/storage.html">Persistent Storage</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/remote_commands.html">Remote Commands</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/port_forwarding.html">Port Forwarding</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/throttling.html">Throttling</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/scm.html">Source Control Management</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/admission_controllers.html">Admission Controllers</a></li>
                  <li><a class="" href="../../architecture/additional_concepts/other_api_objects.html">Other API Objects</a></li>
              </ul>
            </li>
            <li><a class="" href="../../architecture/revhistory_architecture.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-down"></span>Installation and Configuration
      </a>
      <ul id="topicGroup4" class="collapse in list-unstyled">
            <li><a class="" href="../../install_config/index.html">Overview</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-1">
                <span id="sgSpan-4-1" class="fa fa-caret-right"></span>&nbsp;Installing
              </a>
              <ul id="topicSubGroup-4-1" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/install/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/install/prerequisites.html">Prerequisites</a></li>
                  <li><a class="" href="../../install_config/install/rpm_vs_containerized.html">RPM vs Containerized</a></li>
                  <li><a class="" href="../../install_config/install/quick_install.html">Quick Installation</a></li>
                  <li><a class="" href="../../install_config/install/advanced_install.html">Advanced Installation</a></li>
                  <li><a class="" href="../../install_config/install/disconnected_install.html">Disconnected Installation</a></li>
                  <li><a class="" href="../../install_config/install/docker_registry.html">Deploying a Docker Registry</a></li>
                  <li><a class="" href="../../install_config/install/deploy_router.html">Deploying a Router</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-2">
                <span id="sgSpan-4-2" class="fa fa-caret-down"></span>&nbsp;Upgrading
              </a>
              <ul id="topicSubGroup-4-2" class="nav-tertiary list-unstyled collapse in">
                  <li><a class="" href="../../install_config/upgrading/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/upgrading/automated_upgrades.html">Automated Upgrades</a></li>
                  <li><a class=" active" href="../../install_config/upgrading/manual_upgrades.html">Manual Upgrades</a></li>
              </ul>
            </li>
            <li><a class="" href="../../install_config/downgrade.html">Downgrading</a></li>
            <li><a class="" href="../../install_config/master_node_configuration.html">Master and Node Configuration</a></li>
            <li><a class="" href="../../install_config/imagestreams_templates.html">Loading the Default Image Streams and Templates</a></li>
            <li><a class="" href="../../install_config/certificate_customization.html">Configuring Custom Certificates</a></li>
            <li><a class="" href="../../install_config/configuring_authentication.html">Configuring Authentication and User Agent</a></li>
            <li><a class="" href="../../install_config/syncing_groups_with_ldap.html">Syncing Groups With LDAP</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-9">
                <span id="sgSpan-4-9" class="fa fa-caret-right"></span>&nbsp;Advanced LDAP Configuration
              </a>
              <ul id="topicSubGroup-4-9" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/sssd_for_ldap_failover.html">Setting up SSSD for LDAP Failover</a></li>
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/configuring_form_based_authentication.html">Configuring Form-Based Authentication</a></li>
                  <li><a class="" href="../../install_config/advanced_ldap_configuration/configuring_extended_ldap_attributes.html">Configuring Extended LDAP Attributes</a></li>
              </ul>
            </li>
            <li><a class="" href="../../install_config/configuring_sdn.html">Configuring the SDN</a></li>
            <li><a class="" href="../../install_config/configuring_aws.html">Configuring for AWS</a></li>
            <li><a class="" href="../../install_config/configuring_openstack.html">Configuring for OpenStack</a></li>
            <li><a class="" href="../../install_config/configuring_gce.html">Configuring for GCE</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-14">
                <span id="sgSpan-4-14" class="fa fa-caret-right"></span>&nbsp;Configuring Persistent Storage
              </a>
              <ul id="topicSubGroup-4-14" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/persistent_storage/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_nfs.html">Using NFS</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_glusterfs.html">Using GlusterFS</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_cinder.html">Using OpenStack Cinder</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_ceph_rbd.html">Using Ceph RBD</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_aws.html">Using AWS Elastic Block Store</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_gce.html">Using GCE Persistent Disk</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_iscsi.html">Using iSCSI</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/persistent_storage_fibre_channel.html">Using Fibre Channel</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/dynamically_provisioning_pvs.html">Dynamic Provisioning</a></li>
                  <li><a class="" href="../../install_config/persistent_storage/pod_security_context.html">Volume Security</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-15">
                <span id="sgSpan-4-15" class="fa fa-caret-right"></span>&nbsp;Persistent Storage Examples
              </a>
              <ul id="topicSubGroup-4-15" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../install_config/storage_examples/index.html">Overview</a></li>
                  <li><a class="" href="../../install_config/storage_examples/shared_storage.html">Sharing an NFS PV Across Two Pods</a></li>
                  <li><a class="" href="../../install_config/storage_examples/ceph_example.html">Complete Example Using Ceph RBD</a></li>
                  <li><a class="" href="../../install_config/storage_examples/gluster_example.html">Complete Example Using GlusterFS</a></li>
                  <li><a class="" href="../../install_config/storage_examples/privileged_pod_storage.html">Mounting Volumes To Privileged Pods</a></li>
                  <li><a class="" href="../../install_config/storage_examples/gluster_backed_registry.html">Backing Docker Registry with GlusterFS Storage</a></li>
              </ul>
            </li>
            <li><a class="" href="../../install_config/http_proxies.html">Working with HTTP Proxies</a></li>
            <li><a class="" href="../../install_config/build_defaults_overrides.html">Configuring Global Build Defaults and Overrides</a></li>
            <li><a class="" href="../../install_config/configuring_pipeline_execution.html">Configuring Build Pipeline Execution</a></li>
            <li><a class="" href="../../install_config/native_container_routing.html">Native Container Routing</a></li>
            <li><a class="" href="../../install_config/routing_from_edge_lb.html">Routing from Edge Load Balancers</a></li>
            <li><a class="" href="../../install_config/aggregate_logging.html">Aggregating Container Logs</a></li>
            <li><a class="" href="../../install_config/cluster_metrics.html">Enabling Cluster Metrics</a></li>
            <li><a class="" href="../../install_config/web_console_customization.html">Customizing the Web Console</a></li>
            <li><a class="" href="../../install_config/revhistory_install_config.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>Administrator Solutions
      </a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../../admin_solutions/index.html">Overview</a></li>
            <li><a class="" href="../../admin_solutions/master_node_config.html">Master and Node Configuration</a></li>
            <li><a class="" href="../../admin_solutions/user_role_mgmt.html">User and Role Management</a></li>
            <li><a class="" href="../../admin_solutions/authentication.html">Authentication</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6">
        <span id="tgSpan6" class="fa fa-angle-right"></span>Cluster Administration
      </a>
      <ul id="topicGroup6" class="collapse  list-unstyled">
            <li><a class="" href="../../admin_guide/index.html">Overview</a></li>
            <li><a class="" href="../../admin_guide/manage_nodes.html">Managing Nodes</a></li>
            <li><a class="" href="../../admin_guide/manage_users.html">Managing Users</a></li>
            <li><a class="" href="../../admin_guide/managing_projects.html">Managing Projects</a></li>
            <li><a class="" href="../../admin_guide/service_accounts.html">Configuring Service Accounts</a></li>
            <li><a class="" href="../../admin_guide/manage_authorization_policy.html">Managing Authorization Policies</a></li>
            <li><a class="" href="../../admin_guide/manage_scc.html">Managing Security Context Constraints</a></li>
            <li><a class="" href="../../admin_guide/quota.html">Setting Quotas</a></li>
            <li><a class="" href="../../admin_guide/limits.html">Setting Limit Ranges</a></li>
            <li><a class="" href="../../admin_guide/pruning_resources.html">Pruning Objects</a></li>
            <li><a class="" href="../../admin_guide/garbage_collection.html">Garbage Collection</a></li>
            <li><a class="" href="../../admin_guide/scheduler.html">Scheduler</a></li>
            <li><a class="" href="../../admin_guide/allocating_node_resources.html">Allocating Node Resources</a></li>
            <li><a class="" href="../../admin_guide/overcommit.html">Overcommitting</a></li>
            <li><a class="" href="../../admin_guide/limit_runonce_pod_duration.html">Limit Run-once Pod Duration</a></li>
            <li><a class="" href="../../admin_guide/router.html">Monitoring Routers</a></li>
            <li><a class="" href="../../admin_guide/high_availability.html">High Availability</a></li>
            <li><a class="" href="../../admin_guide/pod_network.html">Managing Pod Networks</a></li>
            <li><a class="" href="../../admin_guide/iptables.html">IPtables</a></li>
            <li><a class="" href="../../admin_guide/securing_builds.html">Securing Builds by Strategy</a></li>
            <li><a class="" href="../../admin_guide/building_dependency_trees.html">Building Dependency Trees</a></li>
            <li><a class="" href="../../admin_guide/sdn_troubleshooting.html">Troubleshooting Networking</a></li>
            <li><a class="" href="../../admin_guide/revhistory_admin_guide.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7">
        <span id="tgSpan7" class="fa fa-angle-right"></span>CLI Reference
      </a>
      <ul id="topicGroup7" class="collapse  list-unstyled">
            <li><a class="" href="../../cli_reference/index.html">Overview</a></li>
            <li><a class="" href="../../cli_reference/get_started_cli.html">Get Started with the CLI</a></li>
            <li><a class="" href="../../cli_reference/manage_cli_profiles.html">Managing CLI Profiles</a></li>
            <li><a class="" href="../../cli_reference/basic_cli_operations.html">Developer CLI Operations</a></li>
            <li><a class="" href="../../cli_reference/admin_cli_operations.html">Administrator CLI Operations</a></li>
            <li><a class="" href="../../cli_reference/revhistory_cli_reference.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup8">
        <span id="tgSpan8" class="fa fa-angle-right"></span>Developer Guide
      </a>
      <ul id="topicGroup8" class="collapse  list-unstyled">
            <li><a class="" href="../../dev_guide/index.html">Overview</a></li>
            <li><a class="" href="../../dev_guide/application_lifecycle.html">Application Life Cycle Examples</a></li>
            <li><a class="" href="../../dev_guide/authentication.html">Authentication</a></li>
            <li><a class="" href="../../dev_guide/projects.html">Projects</a></li>
            <li><a class="" href="../../dev_guide/new_app.html">Creating New Applications</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-8-5">
                <span id="sgSpan-8-5" class="fa fa-caret-right"></span>&nbsp;Application Tutorials
              </a>
              <ul id="topicSubGroup-8-5" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../dev_guide/app_tutorials/index.html">Overview</a></li>
                  <li><a class="" href="../../dev_guide/app_tutorials/quickstarts.html">Quickstart Templates</a></li>
                  <li><a class="" href="../../dev_guide/app_tutorials/ruby_on_rails.html">Ruby on Rails</a></li>
              </ul>
            </li>
            <li><a class="" href="../../dev_guide/ssh_environment.html">Opening a Remote Shell to Containers</a></li>
            <li><a class="" href="../../dev_guide/templates.html">Templates</a></li>
            <li><a class="" href="../../dev_guide/service_accounts.html">Service Accounts</a></li>
            <li><a class="" href="../../dev_guide/builds.html">Builds</a></li>
            <li><a class="" href="../../dev_guide/managing_images.html">Managing Images</a></li>
            <li><a class="" href="../../dev_guide/compute_resources.html">Quotas and Limit Ranges</a></li>
            <li><a class="" href="../../dev_guide/deployments.html">Deployments</a></li>
            <li><a class="" href="../../dev_guide/routes.html">Routes</a></li>
            <li><a class="" href="../../dev_guide/integrating_external_services.html">Integrating External Services</a></li>
            <li><a class="" href="../../dev_guide/secrets.html">Secrets</a></li>
            <li><a class="" href="../../dev_guide/configmaps.html">ConfigMaps</a></li>
            <li><a class="" href="../../dev_guide/pod_autoscaling.html">Pod Autoscaling</a></li>
            <li><a class="" href="../../dev_guide/volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../../dev_guide/persistent_volumes.html">Using Persistent Volumes</a></li>
            <li><a class="" href="../../dev_guide/executing_remote_commands.html">Executing Remote Commands</a></li>
            <li><a class="" href="../../dev_guide/copy_files_to_container.html">Copying Files</a></li>
            <li><a class="" href="../../dev_guide/port_forwarding.html">Port Forwarding</a></li>
            <li><a class="" href="../../dev_guide/shared_memory.html">Shared Memory</a></li>
            <li><a class="" href="../../dev_guide/application_health.html">Application Health</a></li>
            <li><a class="" href="../../dev_guide/events.html">Events</a></li>
            <li><a class="" href="../../dev_guide/downward_api.html">Downward API</a></li>
            <li><a class="" href="../../dev_guide/environment_variables.html">Managing Environment Variables</a></li>
            <li><a class="" href="../../dev_guide/jobs.html">Jobs</a></li>
            <li><a class="" href="../../dev_guide/revhistory_dev_guide.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup9">
        <span id="tgSpan9" class="fa fa-angle-right"></span>Creating Images
      </a>
      <ul id="topicGroup9" class="collapse  list-unstyled">
            <li><a class="" href="../../creating_images/index.html">Overview</a></li>
            <li><a class="" href="../../creating_images/guidelines.html">Guidelines</a></li>
            <li><a class="" href="../../creating_images/metadata.html">Image Metadata</a></li>
            <li><a class="" href="../../creating_images/s2i.html">S2I Requirements</a></li>
            <li><a class="" href="../../creating_images/s2i_testing.html">Testing S2I Images</a></li>
            <li><a class="" href="../../creating_images/custom.html">Custom Builder</a></li>
            <li><a class="" href="../../creating_images/revhistory_creating_images.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup10">
        <span id="tgSpan10" class="fa fa-angle-right"></span>Using Images
      </a>
      <ul id="topicGroup10" class="collapse  list-unstyled">
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-0">
                <span id="sgSpan-10-0" class="fa fa-caret-right"></span>&nbsp;Source-to-Image (S2I)
              </a>
              <ul id="topicSubGroup-10-0" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/s2i_images/index.html">Overview</a></li>
                  <li><a class="" href="../../using_images/s2i_images/nodejs.html">Node.js</a></li>
                  <li><a class="" href="../../using_images/s2i_images/ruby.html">Ruby</a></li>
                  <li><a class="" href="../../using_images/s2i_images/perl.html">Perl</a></li>
                  <li><a class="" href="../../using_images/s2i_images/php.html">PHP</a></li>
                  <li><a class="" href="../../using_images/s2i_images/python.html">Python</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-1">
                <span id="sgSpan-10-1" class="fa fa-caret-right"></span>&nbsp;Database Images
              </a>
              <ul id="topicSubGroup-10-1" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/db_images/index.html">Overview</a></li>
                  <li><a class="" href="../../using_images/db_images/mysql.html">MySQL</a></li>
                  <li><a class="" href="../../using_images/db_images/postgresql.html">PostgreSQL</a></li>
                  <li><a class="" href="../../using_images/db_images/mongodb.html">MongoDB</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-2">
                <span id="sgSpan-10-2" class="fa fa-caret-right"></span>&nbsp;Docker Images
              </a>
              <ul id="topicSubGroup-10-2" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/docker_images/index.html">Overview</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-3">
                <span id="sgSpan-10-3" class="fa fa-caret-right"></span>&nbsp;Other Images
              </a>
              <ul id="topicSubGroup-10-3" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/other_images/index.html">Overview</a></li>
                  <li><a class="" href="../../using_images/other_images/jenkins.html">Jenkins</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-10-4">
                <span id="sgSpan-10-4" class="fa fa-caret-right"></span>&nbsp;xPaaS Middleware Images
              </a>
              <ul id="topicSubGroup-10-4" class="nav-tertiary list-unstyled collapse">
                  <li><a class="" href="../../using_images/xpaas_images/index.html">Overview</a></li>
              </ul>
            </li>
            <li><a class="" href="../../using_images/revhistory_using_images.html">Revision History</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup11">
        <span id="tgSpan11" class="fa fa-angle-right"></span>REST API Reference
      </a>
      <ul id="topicGroup11" class="collapse  list-unstyled">
            <li><a class="" href="../../rest_api/index.html">Overview</a></li>
            <li><a class="" href="../../rest_api/openshift_v1.html">OpenShift v1</a></li>
            <li><a class="" href="../../rest_api/kubernetes_v1.html">Kubernetes v1</a></li>
            <li><a class="" href="../../rest_api/revhistory_rest_api.html">Revision History</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Performing Manual Cluster Upgrades</h2>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#overview">Overview</a></li>
<li><a href="#preparing-for-a-manual-upgrade">Preparing for a Manual Upgrade</a></li>
<li><a href="#upgrading-masters">Upgrading Master Components</a></li>
<li><a href="#updating-policy-definitions">Updating Policy Definitions</a></li>
<li><a href="#upgrading-nodes">Upgrading Nodes</a></li>
<li><a href="#upgrading-the-router">Upgrading the Router</a></li>
<li><a href="#upgrading-the-registry">Upgrading the Registry</a>
<ul class="sectlevel2">
<li><a href="#enforcing-quota-in-the-registry">Enforcing Quota in the Registry</a></li>
</ul>
</li>
<li><a href="#updating-the-default-image-streams-and-templates">Updating the Default Image Streams and Templates</a></li>
<li><a href="#importing-the-latest-images">Importing the Latest Images</a></li>
<li><a href="#manual-upgrading-efk-logging-stack">Upgrading the EFK Logging Stack</a></li>
<li><a href="#manual-upgrading-cluster-metrics">Upgrading Cluster Metrics</a></li>
<li><a href="#additional-instructions-per-release">Additional Manual Steps Per Release</a>
<ul class="sectlevel2">
<li><a href="#manual-step-ose-3-2-0">OpenShift Enterprise 3.2.0</a></li>
<li><a href="#manual-step-ose-3-2-1-1">OpenShift Enterprise 3.2.1.1</a></li>
<li><a href="#manual-step-ose-3-2-1-4">OpenShift Enterprise 3.2.1.4</a></li>
<li><a href="#manual-step-ose-3-2-1-9">OpenShift Enterprise 3.2.1.9</a></li>
</ul>
</li>
<li><a href="#manual-upgrades-verifying-the-upgrade">Verifying the Upgrade</a></li>
<li><a href="#manual-upgrades-advanced-topics">Advanced Topics</a>
<ul class="sectlevel2">
<li><a href="#manual-upgrades-preparing-for-upgrade">Preparing for Upgrade</a></li>
<li><a href="#manual-upgrades-warming-the-new-nodes">Warming the New Nodes</a></li>
<li><a href="#manual-upgrades-node-evacuation">Node Evacuation</a></li>
<li><a href="#manual-upgrades-summary">Summary</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an alternative to performing an
<a href="../../install_config/upgrading/automated_upgrades.html#install-config-upgrading-automated-upgrades">automated upgrade</a>,
you can manually upgrade your OpenShift cluster. To manually upgrade without
disruption, it is important to upgrade each component as documented in this
topic.</p>
</div>
<div class="paragraph">
<p>Before you begin your upgrade, familiarize yourself now with the entire
procedure. <a href="#additional-instructions-per-release">Specific releases may
require additional steps</a> to be performed at key points before or during the
standard upgrade process.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="preparing-for-a-manual-upgrade"><a class="anchor" href="#preparing-for-a-manual-upgrade"></a>Preparing for a Manual Upgrade</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are on OpenShift Enterprise 3.0, you must first upgrade to 3.1 before
upgrading to 3.2. Further, if you are currently using the Pacemaker HA method,
you must first upgrade to the native HA method before upgrading to 3.2, as the
Pacemaker method is no longer supported starting with 3.2. See the
<a href="https://docs.openshift.com/enterprise/3.1/install_config/upgrading/index.html">OpenShift
Enterprise 3.1 upgrade documentation</a> for instructions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To prepare for a manual upgrade, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you are upgrading from OpenShift Enterprise 3.1 to 3.2, manually disable the
3.1 channel and enable the 3.2 channel on each host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --disable="rhel-7-server-ose-3.1-rpms" \
    --enable="rhel-7-server-ose-3.2-rpms" \
    --enable="rhel-7-server-extras-rpms"</pre>
</div>
</div>
<div class="paragraph">
<p>On RHEL 7 systems, also clear the <strong>yum</strong> cache:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum clean all</pre>
</div>
</div>
</li>
<li>
<p>Install or update to the latest available version of the
<strong>atomic-openshift-utils</strong> package on each RHEL 7 system, which provides files
that will be used in later sections:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install atomic-openshift-utils</pre>
</div>
</div>
<div class="paragraph">
<p>Because RHEL Atomic Host 7 systems cannot use <strong>yum</strong>, you must download the
<strong>atomic-openshift-utils</strong> package on a subscribed RHEL 7 system and copy the
following file to any RHEL Atomic Host 7 systems to be used later:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">/usr/share/ansible/openshift-ansible/playbooks/common/openshift-cluster/upgrades/files/nuke_images.sh</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This file was previously located at
<strong><em>/usr/share/ansible/openshift-ansible/playbooks/byo/openshift-cluster/upgrades/docker/files/nuke_images.sh</em></strong>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Create an <strong>etcd</strong> backup on each master. The <strong>etcd</strong> package is required, even if
using embedded etcd, for access to the <code>etcdctl</code> command to make the backup. The
package is installed by default for RHEL Atomic Host 7 systems. If the master is
a RHEL 7 system, ensure the package is installed:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install etcd</pre>
</div>
</div>
<div class="paragraph">
<p>Then, create the backup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># etcdctl backup --data-dir /var/lib/origin/openshift.local.etcd \
    --backup-dir /var/lib/origin/openshift.local.etcd.bak.&lt;date&gt; <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set the date of the backup in <code>&lt;date&gt;</code>, or some unique identifier. The command
will not make a backup if the <code>--backup-dir</code> location already exists.</td>
</tr>
</table>
</div>
</li>
<li>
<p>For any upgrade path, ensure that you are running the latest kernel on
each RHEL 7 system:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update kernel</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-masters"><a class="anchor" href="#upgrading-masters"></a>Upgrading Master Components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Upgrade your master hosts first:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upgrade the <strong>atomic-openshift</strong> packages or related images.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For masters using the RPM-based method on a RHEL 7 system, upgrade all installed
<strong>atomic-openshift</strong> packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum upgrade atomic-openshift\*</pre>
</div>
</div>
</li>
<li>
<p>For masters using the containerized method on a RHEL 7 or RHEL Atomic Host 7
system, set the <code><strong>IMAGE_VERSION</strong></code> parameter to the version you are upgrading to
in the following files:</p>
<div class="ulist">
<ul>
<li>
<p><strong><em>/etc/sysconfig/atomic-openshift-master</em></strong> (single master clusters only)</p>
</li>
<li>
<p><strong><em>/etc/sysconfig/atomic-openshift-master-controllers</em></strong> (multi-master clusters only)</p>
</li>
<li>
<p><strong><em>/etc/sysconfig/atomic-openshift-master-api</em></strong> (multi-master clusters only)</p>
</li>
<li>
<p><strong><em>/etc/sysconfig/atomic-openshift-node</em></strong></p>
</li>
<li>
<p><strong><em>/etc/sysconfig/atomic-openshift-openvswitch</em></strong></p>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">IMAGE_VERSION=v3.2.1.9</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Restart the master service(s) on each master and review logs to ensure they
restart successfully.</p>
<div class="paragraph">
<p>For single master clusters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart atomic-openshift-master
# journalctl -r -u atomic-openshift-master</pre>
</div>
</div>
<div class="paragraph">
<p>For multi-master clusters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart atomic-openshift-master-controllers
# systemctl restart atomic-openshift-master-api
# journalctl -r -u atomic-openshift-master-controllers
# journalctl -r -u atomic-openshift-master-api</pre>
</div>
</div>
</li>
<li>
<p>Because masters also have node components running on them in order to be
configured as part of the OpenShift SDN, restart the <strong>atomic-openshift-node</strong> and
<strong>openvswitch</strong> services:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart atomic-openshift-node
# systemctl restart openvswitch
# journalctl -r -u openvswitch
# journalctl -r -u atomic-openshift-node</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Upgrade any external etcd hosts using the RPM-based method on a RHEL 7 system:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Upgrade the <strong>etcd</strong> package:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update etcd</pre>
</div>
</div>
</li>
<li>
<p>Restart the <strong>etcd</strong> service and review the logs to ensure it restarts
successfully:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart etcd
# journalctl -r -u etcd</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you are performing a cluster upgrade that requires updating Docker to version
1.10,
such as OpenShift Enterprise 3.1 to 3.2 or 3.2.0 to 3.2.1,
you must also perform the following steps if you are not already on Docker 1.10:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The node component on masters is set by default to unschedulable status during
initial installation, so that pods are not deployed to them. However, it is
possible to set them schedulable during the initial installation or manually
thereafter. If any of your masters are also configured as a schedulable node,
skip the following Docker upgrade steps for those masters and instead run all
steps described in <a href="#upgrading-nodes">Upgrading Nodes</a> when you get to that
section for those hosts as well.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the following script on each master and external etcd host to remove all
containers and images, which is required to avoid a long upgrade process for
older images after Docker is updated. Containers and images for pods backed by
replication controllers will be recreated automatically:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod u+x /usr/share/ansible/openshift-ansible/playbooks/common/openshift-cluster/upgrades/files/nuke_images.sh
# /usr/share/ansible/openshift-ansible/playbooks/common/openshift-cluster/upgrades/files/nuke_images.sh</pre>
</div>
</div>
</li>
<li>
<p>Upgrade Docker.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For RHEL 7 systems:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update docker</pre>
</div>
</div>
<div class="paragraph">
<p>Then, restart the <strong>docker</strong> service and review the logs to ensure it restarts
successfully:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart docker
# journalctl -r -u docker</pre>
</div>
</div>
</li>
<li>
<p>For RHEL Atomic Host 7 systems, upgrade to the latest Atomic tree if one is
available:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If upgrading to RHEL Atomic Host 7.2.5, this upgrades Docker to version 1.10.
See the
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-1-enhancements">OpenShift Enterprise
3.2.1.1 release notes</a> for details and known issues.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># atomic host upgrade</pre>
</div>
</div>
<div class="paragraph">
<p>After the upgrade is completed and prepared for the next boot, reboot the host
and ensure the <strong>docker</strong> service starts successfully:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl reboot
# journalctl -r -u docker</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>During the upgrade, it can sometimes be useful to take a master out of rotation
since some DNS client libraries will not properly to the other masters for
cluster DNS. In addition to stopping the master and controller services, you
can remove the EndPoint from the Kubernetes service&#8217;s <code><strong>subsets.addresses</strong></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc edit ep/kubernetes -n default</pre>
</div>
</div>
<div class="paragraph">
<p>When the master is restarted, the Kubernetes service will be automatically
updated.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-policy-definitions"><a class="anchor" href="#updating-policy-definitions"></a>Updating Policy Definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After a cluster upgrade, the recommended
<a href="../../architecture/additional_concepts/authorization.html#roles">default
cluster roles</a> may be updated. To check if an update is recommended for
your environment, you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm policy reconcile-cluster-roles</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have customized default cluster roles and want to ensure a role reconciliation
does not modify those customized roles, annotate them with <code>openshift.io/reconcile-protect</code>
set to <code>true</code>. Doing so means you are responsible for manually updating those roles with
any new or required permissions during upgrades.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This command outputs a list of roles that are out of date and their new proposed
values. For example:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm policy reconcile-cluster-roles
apiVersion: v1
items:
- apiVersion: v1
  kind: ClusterRole
  metadata:
    creationTimestamp: null
    name: admin
  rules:
  - attributeRestrictions: null
    resources:
    - builds/custom
...</pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Your output will vary based on the OpenShift version and any local
customizations you have made. Review the proposed policy carefully.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can either modify this output to re-apply any local policy changes you have
made, or you can automatically apply the new policy using the following process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Reconcile the cluster roles:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm policy reconcile-cluster-roles \
    --additive-only=true \
    --confirm</pre>
</div>
</div>
</li>
<li>
<p>Reconcile the cluster role bindings:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm policy reconcile-cluster-role-bindings \
    --exclude-groups=system:authenticated \
    --exclude-groups=system:authenticated:oauth \
    --exclude-groups=system:unauthenticated \
    --exclude-users=system:anonymous \
    --additive-only=true \
    --confirm</pre>
</div>
</div>
</li>
<li>
<p>Reconcile the cluster roles again to pick up new capabilities:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm policy reconcile-cluster-roles \
    --additive-only=true \
    --confirm</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-nodes"><a class="anchor" href="#upgrading-nodes"></a>Upgrading Nodes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After upgrading your masters, you can upgrade your nodes. When restarting the
<strong>atomic-openshift-node</strong> service, there will be a brief disruption of outbound network
connectivity from running pods to services while the
<a href="../../architecture/infrastructure_components/kubernetes_infrastructure.html#service-proxy">service
proxy</a> is restarted. The length of this disruption should be very short and
scales based on the number of services in the entire cluster.</p>
</div>
<div class="paragraph">
<p>One at at time for each node that is not also a master, you must disable
scheduling and evacuate its pods to other nodes, then upgrade packages and
restart services.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As a user with <strong>cluster-admin</strong> privileges, disable scheduling for the node:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm manage-node &lt;node&gt; --schedulable=false</pre>
</div>
</div>
</li>
<li>
<p>Evacuate pods on the node to other nodes:</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>--force</code> option deletes any pods that are not backed by a replication
controller.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm manage-node &lt;node&gt; --evacuate --force</pre>
</div>
</div>
</li>
<li>
<p>Upgrade the node component packages or related images.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For nodes using the RPM-based method on a RHEL 7 system, upgrade all installed
<strong>atomic-openshift</strong> packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum upgrade atomic-openshift\*</pre>
</div>
</div>
</li>
<li>
<p>For nodes using the containerized method on a RHEL 7 or RHEL Atomic Host 7
system, set the <code><strong>IMAGE_VERSION</strong></code> parameter in the
<strong><em>/etc/sysconfig/atomic-openshift-node</em></strong> and <strong><em>/etc/sysconfig/openvswitch</em></strong>
files to the version you are upgrading to. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">IMAGE_VERSION=v3.2.1.9</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Restart the <strong>atomic-openshift-node</strong> and <strong>openvswitch</strong> services and review the
logs to ensure they restart successfully:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart atomic-openshift-node
# systemctl restart openvswitch
# journalctl -r -u atomic-openshift-node
# journalctl -r -u openvswitch</pre>
</div>
</div>
</li>
<li>
<p>If you are performing a cluster upgrade that requires updating Docker to version
1.10,
such as OpenShift Enterprise 3.1 to 3.2 or 3.2.0 to 3.2.1,
you must also perform the following steps if you are not already on Docker 1.10:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the following script to remove all containers and images, which is required
to avoid a long upgrade process for older images after Docker is updated.
Containers and images for pods backed by replication controllers will be
recreated automatically:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chmod u+x /usr/share/ansible/openshift-ansible/playbooks/common/openshift-cluster/upgrades/files/nuke_images.sh
# /usr/share/ansible/openshift-ansible/playbooks/common/openshift-cluster/upgrades/files/nuke_images.sh</pre>
</div>
</div>
</li>
<li>
<p>Upgrade Docker.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>For RHEL 7 systems:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update docker</pre>
</div>
</div>
<div class="paragraph">
<p>Then, restart the <strong>docker</strong> service and review the logs to ensure it restarts
successfully:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart docker
# journalctl -r -u docker</pre>
</div>
</div>
<div class="paragraph">
<p>After Docker is restarted, restart the <strong>atomic-openshift-node</strong> service again and
review the logs to ensure it restarts successfully:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart atomic-openshift-node
# journalctl -r -u atomic-openshift-node</pre>
</div>
</div>
</li>
<li>
<p>For RHEL Atomic Host 7 systems, upgrade to the latest Atomic tree if one is
available:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If upgrading to RHEL Atomic Host 7.2.5, this upgrades Docker to version 1.10.
See the
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-1-enhancements">OpenShift Enterprise
3.2.1.1 release notes</a> for details and known issues.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># atomic host upgrade</pre>
</div>
</div>
<div class="paragraph">
<p>After the upgrade is completed and prepared for the next boot, reboot the host
and ensure the <strong>docker</strong> service starts successfully:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl reboot
# journalctl -r -u docker</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Re-enable scheduling for the node:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm manage-node &lt;node&gt; --schedulable</pre>
</div>
</div>
</li>
<li>
<p>Repeat these steps on the next node, and continue repeating these steps until
all nodes have been upgraded.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After all nodes have been upgraded, as a user with <strong>cluster-admin</strong> privileges,
verify that all nodes are showing as <strong>Ready</strong>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc get nodes
NAME                    LABELS                                        STATUS
master.example.com      kubernetes.io/hostname=master.example.com     Ready,SchedulingDisabled
node1.example.com       kubernetes.io/hostname=node1.example.com      Ready
node2.example.com       kubernetes.io/hostname=node2.example.com      Ready</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-the-router"><a class="anchor" href="#upgrading-the-router"></a>Upgrading the Router</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have previously
<a href="../../install_config/install/deploy_router.html#install-config-install-deploy-router">deployed a router</a>, the
router deployment configuration must be upgraded to apply updates contained in
the router image. To upgrade your router without disrupting services, you must
have previously deployed a
<a href="../../admin_guide/high_availability.html#configuring-a-highly-available-routing-service">highly-available
routing service</a>.</p>
</div>
<div class="paragraph">
<p>Edit your router&#8217;s deployment configuration. For example, if it has the default
<strong>router</strong> name:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc edit dc/router</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Apply the following changes:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">...
spec:
 template:
    spec:
      containers:
      - env:
        ...
        image: registry.access.redhat.com/openshift3/ose-haproxy-router:v3.2.1.9 <i class="conum" data-value="1"></i><b>(1)</b>
        imagePullPolicy: IfNotPresent
        ...</pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Adjust the image version to match the version you are upgrading to.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should see one router pod updated and then the next.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="upgrading-the-registry"><a class="anchor" href="#upgrading-the-registry"></a>Upgrading the Registry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The registry must also be upgraded for changes to take effect in the registry
image. If you have used a <code><strong>PersistentVolumeClaim</strong></code> or a host mount point, you
may restart the registry without losing the contents of your registry.
<a href="../../install_config/install/docker_registry.html#storage-for-the-registry">Deploying
a Docker Registry</a> details how to configure persistent storage for the registry.</p>
</div>
<div class="paragraph">
<p>Edit your registry&#8217;s deployment configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc edit dc/docker-registry</pre>
</div>
</div>
<div class="paragraph">
<p>Apply the following changes:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">...
spec:
 template:
    spec:
      containers:
      - env:
        ...
        image: registry.access.redhat.com/openshift3/ose-docker-registry:v3.2.1.9 <i class="conum" data-value="1"></i><b>(1)</b>
        imagePullPolicy: IfNotPresent
        ...</pre>
</div>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Adjust the image version to match the version you are upgrading to.</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Images that are being pushed or pulled from the internal registry at the time of
upgrade will fail and should be restarted automatically. This will not disrupt
pods that are already running.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="enforcing-quota-in-the-registry"><a class="anchor" href="#enforcing-quota-in-the-registry"></a>Enforcing Quota in the Registry</h3>
<div class="paragraph">
<p>Quota must be enforced to prevent layer blobs that exceed the size limit from
being written to the registry&#8217;s storage. This can be achieved via a
<a href="../install/docker_registry.html#registry-configuration-reference">configuration
file</a>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">...
middleware:
  repository:
    - name: openshift
      options:
        enforcequota: true
...</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Alternatively, use the <code><strong>REGISTRY_MIDDLEWARE_REPOSITORY_OPENSHIFT_ENFORCEQUOTA</strong></code>
environment variable, which is set to <code><strong>true</strong></code> for the new registry deployments
by default. Existing deployments need to be modified using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc env dc/docker-registry REGISTRY_MIDDLEWARE_REPOSITORY_OPENSHIFT_ENFORCEQUOTA=true</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-the-default-image-streams-and-templates"><a class="anchor" href="#updating-the-default-image-streams-and-templates"></a>Updating the Default Image Streams and Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the <a href="../../install_config/install/quick_install.html#install-config-install-quick-install">quick</a> and
<a href="../../install_config/install/advanced_install.html#install-config-install-advanced-install">advanced installation</a>
methods automatically create default image streams, InstantApp templates, and
database service templates in the <strong>openshift</strong> project, which is a default
project to which all users have view access. These objects were created during
installation from the JSON files located under the
<strong><em>/usr/share/ansible/openshift-ansible/roles/openshift_examples/files/examples/</em></strong>
directory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Because RHEL Atomic Host 7 cannot use <strong>yum</strong> to update packages, the following
steps must take place on a RHEL 7 system.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To update these objects, first update the packages that provide the example JSON
files. On a subscribed RHEL 7 system where you can run the CLI as a user with
<strong>cluster-admin</strong> permissions, install or update to the latest version of the
<strong>atomic-openshift-utils</strong> package, which should also update the
<strong>openshift-ansible-</strong>* packages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update atomic-openshift-utils</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>openshift-ansible-roles</strong> package provides the latest example JSON files.</p>
</div>
<div class="paragraph">
<p>Now, update the global <strong>openshift</strong> project by running the following commands.
Receiving warnings about items that already exist is expected.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc create -n openshift -f /usr/share/openshift/examples/image-streams/image-streams-rhel7.json
# oc create -n openshift -f /usr/share/openshift/examples/db-templates
# oc create -n openshift -f /usr/share/openshift/examples/quickstart-templates
# oc create -n openshift -f /usr/share/openshift/examples/xpaas-streams
# oc create -n openshift -f /usr/share/openshift/examples/xpaas-templates
# oc replace -n openshift -f /usr/share/openshift/examples/image-streams/image-streams-rhel7.json
# oc replace -n openshift -f /usr/share/openshift/examples/db-templates
# oc replace -n openshift -f /usr/share/openshift/examples/quickstart-templates
# oc replace -n openshift -f /usr/share/openshift/examples/xpaas-streams
# oc replace -n openshift -f /usr/share/openshift/examples/xpaas-templates</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="importing-the-latest-images"><a class="anchor" href="#importing-the-latest-images"></a>Importing the Latest Images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After <a href="#updating-the-default-image-streams-and-templates">updating the
default image streams</a>, you may also want to ensure that the images within those
streams are updated. For each image stream in the default <strong>openshift</strong> project,
you can run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc import-image -n openshift &lt;imagestream&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For example, get the list of all image streams in the default <strong>openshift</strong>
project:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc get is -n openshift
NAME     DOCKER REPO                                                      TAGS                   UPDATED
mongodb  registry.access.redhat.com/openshift3/mongodb-24-rhel7           2.4,latest,v3.1.1.6    16 hours ago
mysql    registry.access.redhat.com/openshift3/mysql-55-rhel7             5.5,latest,v3.1.1.6    16 hours ago
nodejs   registry.access.redhat.com/openshift3/nodejs-010-rhel7           0.10,latest,v3.1.1.6   16 hours ago
...</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Update each image stream one at a time:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc import-image -n openshift nodejs
The import completed successfully.

Name:			nodejs
Created:		10 seconds ago
Labels:			&lt;none&gt;
Annotations:		openshift.io/image.dockerRepositoryCheck=2016-07-05T19:20:30Z
Docker Pull Spec:	172.30.204.22:5000/openshift/nodejs

Tag	Spec								Created		PullSpec						Image
latest	4								9 seconds ago	registry.access.redhat.com/rhscl/nodejs-4-rhel7:latest	570ad8ed927fd5c2c9554ef4d9534cef808dfa05df31ec491c0969c3bd372b05
4	registry.access.redhat.com/rhscl/nodejs-4-rhel7:latest		9 seconds ago	&lt;same&gt;							570ad8ed927fd5c2c9554ef4d9534cef808dfa05df31ec491c0969c3bd372b05
0.10	registry.access.redhat.com/openshift3/nodejs-010-rhel7:latest	9 seconds ago	&lt;same&gt;							a1ef33be788a28ec2bdd48a9a5d174ebcfbe11c8e986d2996b77f5bccaaa4774</pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to update your S2I-based applications, you must manually trigger a new
build of those applications after importing the new images using <code>oc start-build
&lt;app-name&gt;</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manual-upgrading-efk-logging-stack"><a class="anchor" href="#manual-upgrading-efk-logging-stack"></a>Upgrading the EFK Logging Stack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the following to upgrade an
<a href="../../install_config/aggregate_logging.html#install-config-aggregate-logging">already-deployed EFK logging
stack</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following steps apply when upgrading from OpenShift Enterprise
3.1 to 3.2, or are applying an asynchronous update to 3.2. These steps pull
the latest 3.2 logging images.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you are working in the project where the EFK stack was previously
deployed. For example, if the project is named <strong>logging</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc project logging</pre>
</div>
</div>
</li>
<li>
<p>Scale down your Fluentd instances to 0:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale dc/logging-fluentd --replicas=0</pre>
</div>
</div>
<div class="paragraph">
<p>Wait until they have terminated. This helps prevent loss of data by giving them
time to properly flush their current buffer and send any logs they were
processing to Elasticsearch.</p>
</div>
</li>
<li>
<p>Scale down your Kibana instances:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale dc/logging-kibana --replicas=0</pre>
</div>
</div>
<div class="paragraph">
<p>If you have an operations deployment, also run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale dc/logging-kibana-ops --replicas=0</pre>
</div>
</div>
</li>
<li>
<p>Once confirming your Fluentd and Kibana pods have been terminated, scale down
the Elasticsearch pods:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale dc/logging-es-&lt;unique_name&gt; --replicas=0</pre>
</div>
</div>
<div class="paragraph">
<p>If you have an operations deployment, also run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale dc/logging-es-ops-&lt;unique_name&gt; --replicas=0</pre>
</div>
</div>
</li>
<li>
<p>After confirming your Elasticsearch pods have been terminated, rerun the
deployer to generate any missing or changed features.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Follow the first step in
<a href="../../install_config/aggregate_logging.html#deploying-the-efk-stack">Deploying
the EFK Stack</a>. After the deployer completes,
re-attach the persistent volume claims you were previously using, then deploy a
template that is created by the deployer:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc process logging-support-template | oc apply -f -</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Deployment of logging components is intended to happen automatically
based on tags being imported into the image streams created in the previous
step. However, as not all tags are automatically imported, this mechanism
has become unreliable as multiple versions are released. Therefore,
manual importing may be necessary as follows.</p>
<div class="paragraph">
<p>For each image stream <code>logging-auth-proxy</code>, <code>logging-kibana</code>,
<code>logging-elasticsearch</code>, and <code>logging-fluentd</code>, manually import the
tag corresponding to the <code><strong>IMAGE_VERSION</strong></code> specified (or defaulted)
for the deployer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc import-image &lt;name&gt;:&lt;version&gt; --from &lt;prefix&gt;&lt;name&gt;:&lt;tag&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc import-image logging-auth-proxy:3.2.1 \
     --from registry.access.redhat.com/openshift3/logging-auth-proxy:3.2.1
$ oc import-image logging-kibana:3.2.1 \
     --from registry.access.redhat.com/openshift3/logging-kibana:3.2.1
$ oc import-image logging-elasticsearch:3.2.1 \
     --from registry.access.redhat.com/openshift3/logging-elasticsearch:3.2.1
$ oc import-image logging-fluentd:3.2.1 \
     --from registry.access.redhat.com/openshift3/logging-fluentd:3.2.1</pre>
</div>
</div>
</li>
<li>
<p>Next, scale Elasticsearch back up incrementally so that the cluster has time
to rebuild.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>To begin, scale up to 1:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc scale dc/logging-es-&lt;unique_name&gt; --replicas=1</pre>
</div>
</div>
<div class="paragraph">
<p>Follow the logs of the resulting pod to ensure that it is able to recover its
indices correctly and that there are no errors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc logs -f &lt;pod_name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If that is successful, you can then do the same for the operations cluster, if
one was previously used.</p>
</div>
</li>
<li>
<p>After all Elasticsearch nodes have recovered their indices, continue to scale it
back up to the size it was prior to doing maintenance. Check the logs of the
Elasticsearch members to verify that they have correctly joined the cluster and
recovered.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Now scale Kibana and Fluentd back up to their previous state. Because Fluentd
was shut down and allowed to push its remaining records to Elasticsearch in the
previous steps, it can now pick back up from where it left off with no loss of
logs, provided any unread log files are still available on the node.</p>
</li>
<li>
<p>In the latest version, Kibana will display indices differently now in order
to prevent users from being able to access the logs of previously created
projects that have been deleted.</p>
<div class="paragraph">
<p>Due to this change, your old logs will not appear automatically. To migrate your
old indices to the new format, rerun the deployer with <code>-v MODE=migrate</code> in addition
to your prior flags. This should be run while your Elasticsearch cluster is running, as the
script must connect to it to make changes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This only impacts non-operations logs. Operations logs will appear the same as
in previous versions. There should be minimal performance impact to
Elasticsearch while running this and it will not perform an install.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manual-upgrading-cluster-metrics"><a class="anchor" href="#manual-upgrading-cluster-metrics"></a>Upgrading Cluster Metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After upgrading an
<a href="../../install_config/cluster_metrics.html#install-config-cluster-metrics">already-deployed Cluster Metrics install</a>,
you must update to a newer version of the metrics components.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The update process stops all the metrics containers,
updates the metrics configuration files,
and redeploys the newer components.</p>
</li>
<li>
<p>It does not change the metrics route.</p>
</li>
<li>
<p>It does not delete the metrics persistent volume claim.
Metrics stored to persistent volumes before the update
are available after the update completes.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The update deletes all non-persisted metric values
and overwrites local changes to the metrics configurations.
For example, the number of instances in a replica set is not saved.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To update, follow the same steps as when the metrics components were
<a href="../../install_config/cluster_metrics.html#deploying-the-metrics-components">first deployed</a>,
using the
<a href="../../install_config/cluster_metrics.html#modifying-the-deployer-template">correct template</a>,
except this time, specify the <code>MODE=refresh</code> option:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc new-app -f metrics-deployer.yaml \
    -p HAWKULAR_METRICS_HOSTNAME=hm.example.com,MODE=refresh <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>In the original deployment command, there was no <code>MODE=refresh</code>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>During the update, the metrics components do not run.
Because of this, they cannot collect data
and a gap normally appears in the graphs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="additional-instructions-per-release"><a class="anchor" href="#additional-instructions-per-release"></a>Additional Manual Steps Per Release</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some OpenShift releases may have additional instructions specific to that
release that must be performed to fully apply the updates across the cluster.
Read through the following sections carefully depending on your upgrade path, as
you may be required to perform certain steps at key points during the standard
upgrade process described earlier in this topic.</p>
</div>
<div class="paragraph">
<p>See the <a href="../../release_notes/ose_3_2_release_notes.html#release-notes-ose-3-2-release-notes">OpenShift Enterprise
3.2 Release Notes</a> to review the latest release notes.</p>
</div>
<div class="sect2">
<h3 id="manual-step-ose-3-2-0"><a class="anchor" href="#manual-step-ose-3-2-0"></a>OpenShift Enterprise 3.2.0</h3>
<div class="paragraph">
<p>There are no additional manual steps for the upgrade to
<a href="../../release_notes/ose_3_2_release_notes.html#release-notes-ose-3-2-release-notes">OpenShift
Enterprise 3.2.0</a> that are not already mentioned inline during the standard
manual upgrade process.</p>
</div>
</div>
<div class="sect2">
<h3 id="manual-step-ose-3-2-1-1"><a class="anchor" href="#manual-step-ose-3-2-1-1"></a>OpenShift Enterprise 3.2.1.1</h3>
<div class="paragraph">
<p>The upgrade to
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-1">OpenShift
Enterprise 3.2.1.1</a> involves updating to
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-1-enhancements">Docker
1.10</a>. The steps to properly upgrade Docker are higlighted and included inline
in the <a href="#upgrading-masters">Upgrading Master Components</a> and
<a href="#upgrading-nodes">Upgrading Nodes</a> sections. No other additional manual
steps are required for this release.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See the
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-1-known-issues">Known
Issues for OpenShift Enterprise 3.2.1.1</a> for more details on using
OpenShift Enterprise and Docker 1.10.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="manual-step-ose-3-2-1-4"><a class="anchor" href="#manual-step-ose-3-2-1-4"></a>OpenShift Enterprise 3.2.1.4</h3>
<div class="paragraph">
<p>There are no additional manual steps for the upgrade to
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-4">OpenShift Enterprise
3.2.1.4</a> that are not already mentioned inline during the standard manual
upgrade process.</p>
</div>
</div>
<div class="sect2">
<h3 id="manual-step-ose-3-2-1-9"><a class="anchor" href="#manual-step-ose-3-2-1-9"></a>OpenShift Enterprise 3.2.1.9</h3>
<div class="paragraph">
<p>There are no additional manual steps for the upgrade to
<a href="../../release_notes/ose_3_2_release_notes.html#ose-3-2-1-9">OpenShift Enterprise
3.2.1.9</a> that are not already mentioned inline during the standard manual
upgrade process.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manual-upgrades-verifying-the-upgrade"><a class="anchor" href="#manual-upgrades-verifying-the-upgrade"></a>Verifying the Upgrade</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To verify the upgrade, first check that all nodes are marked as <strong>Ready</strong>:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc get nodes
NAME                 LABELS                                                                STATUS
master.example.com   kubernetes.io/hostname=master.example.com,region=infra,zone=default   Ready
node1.example.com    kubernetes.io/hostname=node1.example.com,region=primary,zone=east     Ready</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>Then, verify that you are running the expected versions of the <strong>docker-registry</strong>
and <strong>router</strong> images, if deployed:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oc get -n default dc/docker-registry -o json | grep \"image\"
    "image": "openshift3/ose-docker-registry:v3.2.1.9",
# oc get -n default dc/router -o json | grep \"image\"
    "image": "openshift3/ose-haproxy-router:v3.2.1.9",</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>After upgrading, you can use the diagnostics tool on the master to look for
common issues:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm diagnostics
...
[Note] Summary of diagnostics execution:
[Note] Completed with no errors or warnings seen.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="manual-upgrades-advanced-topics"><a class="anchor" href="#manual-upgrades-advanced-topics"></a>Advanced Topics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Blue-green deployments are a proven approach to reducing downtime caused while
updating an environment. This is done by creating a parallel environment on
which the new deployment can be installed. If a problem is detected and after
the new deployment is verified, traffic can be switched over with the option to
rollback.</p>
</div>
<div class="paragraph">
<p>While blue-green is a valid strategy for deploying just about any software,
there are always trade-offs to be made. Not all environments have the same
uptime requirements or the resources to properly perform blue-green deployments.
In an OpenShift Enterprise environment the most suitable candidate for blue-green
deployments are the Nodes. Uptime is most important for these workloads and the
additional complexity of blue-green deployments can be justified. Often the main
challenge is having the excess capacity to facilitate such an approach.</p>
</div>
<div class="paragraph">
<p>Another lesser challenge is that the administrator will have to temporarily
share the entitlements between the blue-green deployments or provide access to
the installation content by means of a system such as Red Hat Satellite. This
can be accomplished by sharing the consumer ID from the previous host.</p>
</div>
<div class="paragraph">
<p>On the old host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager identity | grep system
system identity: 6699375b-06db-48c4-941e-689efd6ce3aa</pre>
</div>
</div>
<div class="paragraph">
<p>On the new host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager register --consumerid=6699375b-06db-48c4-941e-689efd6ce3aa</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After a successful deployment, remember to unregister the old host with
<code><strong>subscription-manager clean</strong></code> to prevent the environment from being out of
compliance.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="manual-upgrades-preparing-for-upgrade"><a class="anchor" href="#manual-upgrades-preparing-for-upgrade"></a>Preparing for Upgrade</h3>
<div class="paragraph">
<p>xref:#upgrading-masters[After the master and etcd servers have been upgraded],
you need to ensure that your current production nodes are labeled either blue or
green. In this example, the current installation will be blue and the new
environment will be green.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc label --all nodes color=blue</pre>
</div>
</div>
<div class="paragraph">
<p>In the case of nodes requiring the uptime guarantees of a blue-green deployment,
the <code>-l</code> flag can be used to match a subset of the environment using a selector.</p>
</div>
<div class="paragraph">
<p>Next, <a href="../install/advanced_install.html#adding-nodes-advanced">the green
environment</a> should be created for any nodes that are to be replaced. Ansible
can apply the <code><strong>color=green</strong></code> using the <code><strong>openshift_node_labels</strong></code> variable for
each node.</p>
</div>
<div class="paragraph">
<p>In order to delay workload scheduling until the nodes are
<a href="../dev_guide/application_health.html#dev-guide-application-health">healthy</a>,
be sure to set the <code><strong>openshift_schedulable=false</strong></code> variable.</p>
</div>
<div class="paragraph">
<p>Once the green nodes are in <strong>Ready</strong> state, they can be made schedulable. Then,
blue nodes are disabled so that no new pods are run on them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm manage-node --schedulable=true --selector=color=green
# oadm manage-node --schedulable=false --selector=color=blue</pre>
</div>
</div>
<div class="paragraph">
<p>A common practice is to scale the registry and router pods until they are
migrated to the green nodes. For these pods, a <em>canary</em> deployment approach is
commonly used. Scaling them up will make them immediately active on the new
nodes. Pointing the deployment configuration to the new image initiates a
rolling update. However, because of node anti-affinity, and the fact that the
blue nodes are still unschedulable, the deployments to the old nodes will fail.
At this point, the registry and router deployments can be scaled down to the
original number of pods. At any given point, the original number of pods is
still available so no capacity is lost.</p>
</div>
</div>
<div class="sect2">
<h3 id="manual-upgrades-warming-the-new-nodes"><a class="anchor" href="#manual-upgrades-warming-the-new-nodes"></a>Warming the New Nodes</h3>
<div class="paragraph">
<p>In order for pods to be migrated from the blue environment to the green, the
images must be pulled. Network latency and load on the registry can cause delays
if there is not sufficient capacity built in to the environment. Often, the best
way to minimize impact to the running system is to trigger new pod deployments that
will land on the new nodes. Accomplish this by importing new <strong>ImageStreams</strong>.</p>
</div>
<div class="paragraph">
<p>A major release of OpenShift Enterprise is the motivation for a
blue-green deployment. At that time, new <strong>ImageStreams</strong> become
available for users of Source-to-Image. Upon import, any builds or deployments
configured with <strong>ImageChangeTriggers</strong> are automatically created.</p>
</div>
<div class="paragraph">
<p>It is important to realize that this process can trigger a large number of
builds. The good news is that the builds are performed on the green nodes and,
therefore, do not impact any traffic on the blue deployment.</p>
</div>
<div class="paragraph">
<p>Monitor build progress:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ oc get events -w --all-namespaces</pre>
</div>
</div>
<div class="paragraph">
<p>In large environments, builds rarely completely stop. However, you should see a
large increase and decrease caused by the administrative import.</p>
</div>
<div class="paragraph">
<p>Another benefit of triggering the builds is that it does a fairly good job of
fetching the majority of the ancillary images to all nodes such as the various
build images, the pod infrastructure image, and deployers. Everything else can
be moved over using node evacuation and will proceed more quickly as a result.</p>
</div>
</div>
<div class="sect2">
<h3 id="manual-upgrades-node-evacuation"><a class="anchor" href="#manual-upgrades-node-evacuation"></a>Node Evacuation</h3>
<div class="paragraph">
<p>For larger deployments, it is possible to have other labels that help
determine how evacuation can be coordinated. The most conservative approach
for avoiding downtime is to evacuate one node at a time. If services are
composed of pods using zone anti-affinity, then an entire zone can be
evacuated at once. It is important to ensure that the storage volumes used are
available in the new zone as this detail can vary among cloud providers.</p>
</div>
<div class="paragraph">
<p>In OpenShift Enterprise 3.2 and later, a node evacuation is triggered whenever
the service is stopped. Achieve manual evacuation and deletion of all blue nodes
at once by:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># oadm manage-node --selector=color=blue --evacuate
# oc delete node --selector=color=blue</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="manual-upgrades-summary"><a class="anchor" href="#manual-upgrades-summary"></a>Summary</h3>
<div class="paragraph">
<p>In the OpenShift Enterprise environment, the most suitable candidate for blue-green
deployments is the node tier. All user processes run on these systems and even
critical pieces of OpenShift Enterprise infrastructure are self-hosted there. Uptime
is most important for these workloads and the additional complexity of
blue-green deployments can be justified. The exact implementation of this
approach varies based on your requirements.</p>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
    <footer class="footer-openshift">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-4 col-md-3 logo">
        <a href="https://www.redhat.com/"></a>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-6 text-center">
        <div class="row">
          <div class="col-xs-12 col-md-4">
            <a href="https://www.openshift.com/legal/privacy.html">
              Privacy Policy
            </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="https://www.openshift.com/legal/terms.html">
            Terms and Conditions
          </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="http://www.openshift.org/">
            Open Source
          </a>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-3 text-right">
        <a id="built_with_asciibinder" href="http://asciibinder.org/">
          <img src="../../../scollier-test/_images/asciibinder_web_logo.svg" alt="AsciiBinder" />
        </a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>